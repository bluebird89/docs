# PVN Virtual Private Network è™šæ‹Ÿä¸“ç”¨ç½‘ç»œ

## æ¦‚å¿µ

* ä¸­ç»§/ä¸­è½¬/è½åœ°ï¼šä¸¤ä¸ªæˆ–å¤šä¸ªæœåŠ¡å™¨ä¹‹é—´é€šè¿‡ç«¯å£è¿›è¡Œæµé‡è½¬å‘
* IPLC ä¸­ç»§/ä¸­è½¬ï¼šIPLCï¼ˆç‚¹å¯¹ç‚¹çš„å†…ç½‘ä¸“çº¿ï¼‰ï¼Œä¸€å°æœåŠ¡å™¨åœ¨å›½å¤–ä¸€å°æœåŠ¡å™¨åœ¨å›½å†…ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯é€šè¿‡è¿™ä¸¤å°æœåŠ¡å™¨å†…ç½‘ä¼ è¾“çš„
  - ä¼˜åŠ¿ä¸è¿‡GFWï¼ˆæ‰€ä»¥ä¸ä¼šå­˜åœ¨è¢«å°çš„æƒ…å†µï¼‰ï¼Œå› ä¸ºæ˜¯å†…ç½‘ï¼Œé˜²ç«å¢™æ£€æµ‹ä¸åˆ°ï¼Œæ‰€ä»¥åœ¨å›½å†…è®¿é—®çš„å°±æ˜¯å›½å†…çš„æœåŠ¡å™¨ï¼Œç„¶åå›½å†…çš„æœåŠ¡å™¨èµ°å†…ç½‘ä¼ è¾“åˆ°å›½å¤–çš„æœåŠ¡å™¨å¸®æˆ‘ä»¬ä¸Šç½‘ï¼Œæ‰€ä»¥å…¶å°±æ˜¯å°±æ˜¯å¿«ï¼Œç¨³å®šï¼Œä¸ä¼šå—é«˜å³°æœŸå½±å“
  - æˆæœ¬é«˜ï¼ŒåŸºæœ¬ä¸Šæ˜¯æŒ‰ç…§æµé‡å»å–çš„ï¼Œæ‰€ä»¥è¿™ç§æ˜¯é™åˆ¶ç”¨æˆ·æµé‡çš„
* BGP ä¸­ç»§/ä¸­è½¬ï¼šå›½å†…ä¸€å°æœåŠ¡å™¨ï¼Œå›½å¤–ä¸€å°æœåŠ¡å™¨ï¼Œä½†æ˜¯ä¸IPLCä¸åŒçš„æ˜¯èµ°çš„æ˜¯å…¬ç½‘ã€‚ä½¿ç”¨äº†BGPä¸€åå¯¹çº¿è·¯çš„ä¼˜åŒ–æ˜¯ç‰¹åˆ«æ˜æ˜¾çš„ï¼Œä½†ç»™çº¿è·¯å¢åŠ BGPæœåŠ¡å™¨æ˜¯èŠ±é’±çš„ï¼Œè¿™ä¹Ÿå°±å¢åŠ äº†æˆæœ¬ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä¼šç»™é¦™æ¸¯è¿™ä¹ˆè¿‘çš„èŠ‚ç‚¹å¢åŠ BGPæœåŠ¡å™¨
* BGP åè®®/æŠ€æœ¯ï¼šé€šè¿‡BGPå¯ä»¥å®ç°ä¸€ä¸ªIPå¯¹åº”ç”µä¿¡ã€è”é€šã€ç§»åŠ¨ã€é•¿åŸã€æ•™è‚²ç½‘ç­‰ä¸åŒçº¿è·¯çš„å¸¦å®½ï¼Œè€Œä¸éœ€è¦æœåŠ¡å™¨ç«¯é…ç½®å¤šä¸ªIP
  - BGPï¼ˆè¾¹ç•Œç½‘å…³åè®®ï¼‰ä¸»è¦ç”¨äºäº’è”ç½‘ASï¼ˆè‡ªæ²»ç³»ç»Ÿï¼‰ä¹‹é—´çš„äº’è”ï¼ŒBGPæœ€ä¸»è¦çš„åŠŸèƒ½åœ¨äºæ§åˆ¶è·¯ç”±çš„ä¼ æ’­å’Œé€‰æ‹©æœ€å¥½çš„è·¯ç”±ã€‚
  - ä¸­å›½ç½‘é€šã€ä¸­å›½ç”µä¿¡ã€ä¸­å›½é“é€šå’Œä¸€äº›å¤§çš„æ°‘è¥IDCè¿è¥å•†éƒ½å…·æœ‰ASå·ï¼Œå…¨å›½å„å¤§ç½‘ç»œè¿è¥å•†å¤šæ•°éƒ½æ˜¯é€šè¿‡BGPåè®®ä¸è‡ªèº«çš„ASå·æ¥å®ç°å¤šçº¿äº’è”çš„
  - ä½¿ç”¨æ­¤æ–¹æ¡ˆæ¥å®ç°å¤šçº¿è·¯äº’è”ï¼ŒIDCéœ€è¦åœ¨CNNICï¼ˆä¸­å›½äº’è”ç½‘ä¿¡æ¯ä¸­å¿ƒï¼‰æˆ–APNICï¼ˆäºšå¤ªç½‘ç»œä¿¡æ¯ä¸­å¿ƒï¼‰ç”³è¯·è‡ªå·±çš„IPåœ°å€æ®µå’ŒASå·ï¼Œç„¶åé€šè¿‡BGPåè®®å°†æ­¤æ®µIPåœ°å€å¹¿æ’­åˆ°å…¶å®ƒç½‘ç»œè¿è¥å•†çš„ç½‘ç»œä¸­ã€‚ä½¿ç”¨BGPåè®®äº’è”åï¼Œç½‘ç»œè¿è¥å•†çš„æ‰€æœ‰éª¨å¹²è·¯ç”±è®¾å¤‡å°†ä¼šåˆ¤æ–­åˆ°IDCæœºæˆ¿IPæ®µçš„æœ€ä½³è·¯ç”±ï¼Œä»¥ä¿è¯ä¸åŒç½‘ç»œè¿è¥å•†ç”¨æˆ·çš„é«˜é€Ÿè®¿é—®ã€‚æ‰€ä»¥è¯´BGPæ˜¯ç›®å‰å…¨çƒæœ€å¥½çš„åŒçº¿æŠ€æœ¯
  - BGP çº¿è·¯
    + æ¶ˆé™¤å—åŒ—è®¿é—®éšœç¢ã€‚ç”±äºBGPå¯ä»¥å°†è”é€šã€ç”µä¿¡ã€ç§»åŠ¨ç­‰è¿è¥å•†çš„çº¿è·¯â€œåˆå¹¶â€ï¼Œä½¿å¾—ä¸­å›½å—åŒ—æ— éšœç¢é€šè®¯æˆä¸ºå¯èƒ½ã€‚å¯¹æ¥å…¥å±‚æ¥è¯´ï¼Œå¯ä½¿â€œè”é€šã€ç”µä¿¡â€è¿™ç±»åŒºåˆ«æ¶ˆå¤±ï¼Œæ›´èƒ½ä½¿ä¸€ä¸ªç½‘ç«™èµ„æºæ— é™åˆ¶çš„åœ¨å…¨å›½èŒƒå›´å†…æ— éšœç¢è®¿é—®ï¼Œè€Œä¸éœ€è¦åœ¨å¼‚åœ°éƒ¨ç½²VPNæˆ–è€…å¼‚åœ°åŠ é€Ÿç«™æ¥å®ç°å¼‚åœ°æ— éšœç¢è®¿é—®
    + é«˜é€Ÿäº’è”äº’é€š:åŸæ¥ä¸€æ¡çº¿è·¯è®¿é—®å¦ä¸€çº¿è·¯å¾€å¾€è¦ç»è¿‡å¾ˆå¤šå±‚è·¯ç”±ï¼Œä½†å®ç°BGPä»¥åå°±åƒè¿›å…¥äº†é«˜é€Ÿå…¬è·¯,å¸¦å®½çš„åˆ©ç”¨ç‡ç”±40%å·¦å³è¾¾åˆ°80%ä»¥ä¸Š
  - ç”¨äºBGPè·¯ç”±ä¸­çš„æ¯ä¸ªè‡ªæ²»ç³»ç»Ÿéƒ½è¢«åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„è‡ªæ²»ç³»ç»Ÿç¼–å·ï¼ˆASNï¼‰ï¼Œé€šå¸¸ä»¥ASå¼€å¤´ã€‚å¯¹BGPæ¥è¯´ï¼Œå› ä¸ºASNæ˜¯åŒºåˆ«æ•´ä¸ªç›¸äº’è¿æ¥çš„ç½‘ç»œä¸­çš„å„ä¸ªç½‘ç»œçš„å”¯ä¸€æ ‡è¯†ï¼Œæ‰€ä»¥è¿™ä¸ªè‡ªæ²»ç³»ç»Ÿç¼–å·éå¸¸é‡è¦ã€‚ äº’è”ç½‘åœ°å€åˆ†æ´¾æœºæ„å°†64512åˆ°65535çš„ASNç¼–å·ä¿ç•™ç»™ï¼ˆç§æœ‰ï¼‰ä¸“ç”¨ç½‘ç»œä½¿ç”¨
* CN2 GIA å…¨ç§° China telecom Next Carrier Network- Global Internet Access ç”µä¿¡å›½é™…ç²¾å“ç½‘ç»œ
* NCP New Cross Pacificï¼ˆæ–°è·¨å¤ªå¹³æ´‹æµ·åº•å…‰ç¼†ç³»ç»Ÿï¼‰ã€‚2018å¹´11æœˆåº•ï¼Œä¸­å›½åˆ°ç¾å›½ä¹‹é—´çš„æµ·åº•å…‰ç¼†æ–°å¼€é€šäº†NCPçº¿è·¯ï¼Œå¹¶ä¸”å®¹é‡æ›´å¤§ï¼ˆç³»ç»Ÿè®¾è®¡å®¹é‡è¶…è¿‡80Tbpsï¼‰ï¼Œè·¯ç”±æ›´å°‘ï¼ˆä¸­å›½ä¸Šæµ·åˆ°ç¾å›½ä¸­é—´è·¯ç”±èŠ‚ç‚¹åªæœ‰11ä¸ªï¼Œpingå€¼110msï¼‰ã€‚å…¨é•¿13,000å…¬é‡Œï¼Œè¿æ¥ç¾å›½ä¿„å‹’å†ˆå·å¸Œå°”æ–¯ä¼¯å‹’ï¼Œè¿æ¥å´‡æ˜ï¼ˆä¸­å›½å¤§é™†ï¼‰ï¼Œå—æ±‡ï¼ˆä¸­å›½å¤§é™†ï¼‰ï¼Œä¸´æ¸¯ï¼ˆä¸­å›½å¤§é™†ï¼‰ï¼Œé‡œå±±ï¼ˆéŸ©å›½ï¼‰ï¼Œå¤´åŸï¼ˆå°æ¹¾ï¼‰ï¼Œå’Œä¸¸å±±ï¼ˆæ—¥æœ¬ï¼‰
  - ç›¸å¯¹äºç¬¬äºŒæ¡ä¸­ç¾ç›´è¾¾æµ·åº•å…‰ç¼†ç³»ç»Ÿï¼ˆè·¨å¤ªå¹³æ´‹å¿«çº¿ï¼ŒTPEï¼‰ï¼Œç°é˜¶æ®µNCPçº¿è·¯çš„ç½‘ç»œæµé‡æ›´å°‘æ›´ç¨³å®šã€‚ç‰¹å¾æ˜¯åä¸œ/ä¸­åœ°åŒºæµé‡ä¼šç»è¿‡NCPç›´è¾¾è·¯ç”±èŠ‚ç‚¹ï¼ŒIPåœ°å€ä¸º202.97.95.201/202
* ç”¨VPNï¼ŒSSï¼ŒSSRï¼Œéƒ½æœ‰å¯èƒ½è¢«è¯†åˆ«ï¼Œåªæœ‰ä½¿ç”¨ HTTP over TLS çš„æ ·å­ï¼Œæ‰ä¼šè·Ÿæ­£å¸¸çš„æµé‡æ··åœ¨ä¸€èµ·ï¼Œå¾ˆéš¾è¢«è¯†åˆ«ï¼Œæ‰€ä»¥ï¼Œç›®å‰æ¥è¯´ï¼ŒV2Rayå®¢æˆ·ç«¯ + Nginx + V2RayæœåŠ¡ç«¯çš„æ–¹å¼ï¼Œæˆ–æ˜¯gostçš„HTTPSçš„æ–¹å¼ï¼ŒåŸºæœ¬ä¸Šæ¥è¯´ï¼Œåœ¨ç½‘ç»œå››å±‚ä¸Šçœ‹åˆ°çš„éƒ½æ˜¯TLSçš„åŒ…ï¼Œå¾ˆéš¾è¢«è¯†åˆ«ã€‚è¿™ç§ä»£ç†æœåŠ¡è§‰å¾—åªèƒ½åšæ¢æµ‹ï¼Œæˆ–æ˜¯å¾—åˆ°æ›´å¤šçš„ç®—åŠ›æ¥åšç»Ÿè®¡å­¦åˆ†æã€‚æ‰€ä»¥ï¼ŒV2Ray å’Œ gost çš„æœåŠ¡å™¨ç«¯ç”¨ nginx å†æŒ¡ä¸€é“ï¼Œé‚£ä¹ˆå°±å¾ˆéš¾è¢«å‘ç°äº†
* åˆ†æµè§„åˆ™ï¼ˆæˆ–å‡ºç«™æ¨¡å¼ï¼‰:å³é…ç½®å“ªäº›ç½‘ç«™èµ°
  - ä»£ç†æ¨¡å¼ï¼ˆProxyï¼‰å›½å¤–ç½‘ç«™ï¼ˆä¾‹å¦‚Twitter/YouTube/Pornhub/..ï¼‰ä¸æ‰“ä¸å¼€ï¼ˆè¢«å¢™ï¼‰ç½‘ç«™
  - ç›´è¿æ¨¡å¼Direct: å›½å†…ç½‘ç«™
  - æ‹’ç»è®¿é—®ï¼ˆRejectï¼‰

## [Shadowsocks](https://wiki.archlinux.org/index.php/Shadowsocks)

* è½»é‡çº§ SOCKS5 ä»£ç†
* [wiki](https://github.com/shadowsocks/shadowsocks/wiki)
* [](https://github.com/ToyoDAdoubiBackup/doubi)
* [](https://github.com/shadowsocks/go-shadowsocks2)
* [iMeiji/shadowsocks_install](https://github.com/iMeiji/shadowsocks_install)
* [teddysun/shadowsocks_install](https://github.com/teddysun/shadowsocks_install):Auto Install Shadowsocks Server for CentOS/Debian/Ubuntu <https://shadowsocks.be>

```shell
apt-get install python-pip
wget https://bootstrap.pypa.io/ez_setup.py -O - | python

ssserver -p 443 -k password -m rc4-md5
sudo ssserver -p 443 -k password -m rc4-md5 --user nobody -d start // åå°è¿è¡Œ
sudo ssserver -d stop // åœæ­¢
sudo less /var/log/shadowsocks.log // æ—¥å¿—

ssserver -c /etc/shadowsocks.json
ssserver -c /etc/shadowsocks.json -d start
ssserver -c /etc/shadowsocks.json -d stop

brew cask install shadowsocksx

# https://raw.githubusercontent.com/ToyoDAdoubi/doubi/master/ssrmu.sh
wget --no-check-certificate https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks.sh
chmod +x shadowsocks.sh
./shadowsocks.sh 2>&1 | tee shadowsocks.log

/bin/python /usr/local/bin/ssserver -c /etc/shadowsocks.json -d start
### é…ç½®
{
    "server":"my_server_ip",  # æœåŠ¡å™¨ç›‘å¬ip the address your server listens
    "server_port":8388,  #  å¯¹å¤–æœåŠ¡ç«¯å£ server port
    "local_address": "127.0.0.1",  #  æœ¬åœ°ip the address your local listens
    "local_port":1080,   #  local port
    "password":"mypassword",
    "timeout":300,
    "method":"aes-256-cfb",
    "fast_open": false
}
```

## [v2ray-core](https://github.com/v2ray/v2ray-core)

A platform for building proxies to bypass network restrictions. <https://www.v2ray.com/> é€šè¿‡nginxçš„è´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼Œæ¥è‡ªwebè®¿é—®çš„æµé‡å°±ç›´æ¥è®¿é—®åˆ°ç½‘ç«™ï¼Œè€Œé€šè¿‡v2rayæ¥çš„æµé‡å°±é€šè¿‡v2rayçš„æœåŠ¡ç«¯è½¬å‘ï¼Œå®ç°KXä»£ç†çš„åŠŸèƒ½

* æœåŠ¡å™¨ç«¯
  - usr/bin/v2ray/v2rayï¼šV2Ray ç¨‹åºï¼›
  - /usr/bin/v2ray/v2ctlï¼šV2Ray å·¥å…·ï¼›
  - /etc/v2ray/config.jsonï¼šé…ç½®æ–‡ä»¶ï¼›
  - /usr/bin/v2ray/geoip.datï¼šIP æ•°æ®æ–‡ä»¶
  - /usr/bin/v2ray/geosite.datï¼šåŸŸåæ•°æ®æ–‡ä»¶ æ­¤è„šæœ¬ä¼šé…ç½®è‡ªåŠ¨è¿è¡Œè„šæœ¬ã€‚è‡ªåŠ¨è¿è¡Œè„šæœ¬ä¼šåœ¨ç³»ç»Ÿé‡å¯ä¹‹åï¼Œè‡ªåŠ¨è¿è¡Œ V2Rayã€‚ç›®å‰è‡ªåŠ¨è¿è¡Œè„šæœ¬åªæ”¯æŒå¸¦æœ‰ Systemd çš„ç³»ç»Ÿï¼Œä»¥åŠ Debian / Ubuntu å…¨ç³»åˆ—
  - è¿è¡Œè„šæœ¬ä½ç½®
    + /etc/systemd/system/v2ray.service: Systemd
    + /etc/init.d/v2ray: SysV
* [v2rayL](https://github.com/jiangxufeng/v2rayL):v2ray linux GUIå®¢æˆ·ç«¯ï¼Œæ”¯æŒè®¢é˜…ã€vemssã€ssç­‰åè®®ï¼Œè‡ªåŠ¨æ›´æ–°è®¢é˜…ã€æ£€æŸ¥ç‰ˆæœ¬æ›´æ–°

```sh
# å®‰è£…v2ray
bash <(curl -L -s https://install.direct/go.sh) # ç›´æ¥ä½¿ç”¨è„šæœ¬
service v2ray start # å¯åŠ¨
vim /etc/v2ray/config.json # ä¿®æ”¹é…ç½®æ–‡ä»¶
```

## [brook](https://github.com/txthinking/brook)

Brook is a cross-platform(Linux/MacOS/Windows/Android/iOS) proxy/vpn software

## [openvpn](https://help.ubuntu.com/lts/serverguide/openvpn.html)

* æœåŠ¡ç«¯é…ç½®,æä¾›ä¸¤ç§è®¤è¯æ–¹æ³•ï¼š
  * åŸºäºç”¨æˆ·å/å¯†ç çš„è®¤è¯ä¸SSLè¯ä¹¦è®¤è¯ã€‚ç”¨æˆ·å/å¯†ç çš„è®¤è¯æ–¹æ³•æ— æ³•ï¼ˆæˆ–è¾ƒéš¾ï¼‰é™åˆ¶ä¸€ä¸ªè´¦å·åŒæ—¶è¿æ¥å¤šä¸ªå®¢æˆ·ç«¯
  * é‡‡ç”¨è¯ä¹¦ï¼Œåˆ™å¯ä¿è¯åŒä¸€è¯ä¹¦åŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥
* [How To Set Up an OpenVPN Server on Ubuntu 16.04](https://www.digitalocean.com/community/tutorials/how-to-set-up-an-openvpn-server-on-ubuntu-16-04)
* [Nyr/openvpn-install](https://github.com/Nyr/openvpn-install):OpenVPN road warrior installer for Debian, Ubuntu and CentOS

```sh
### Ubunutu
sudo apt install openvpn easy-rsa # æœåŠ¡ç«¯
make-cadir ~/openvpn-ca

mkdir /etc/openvpn/easy-rsa/
cp -r /usr/share/easy-rsa/* /etc/openvpn/easy-rsa/

export KEY_COUNTRY="US" # ç¼–è¾‘/etc/openvpn/easy-rsa/varsè°ƒæ•´åˆ°é€‚åˆæ‚¨çš„ç¯å¢ƒ
export KEY_PROVINCE="NC"
export KEY_CITY="Winston-Salem"
export KEY_ORG="Example Company"
export KEY_EMAIL="steve@example.com"
export KEY_CN=MyVPN
export KEY_NAME=MyVPN
export KEY_OU=MyVPN

cd /etc/openvpn/easy-rsa/
./clean-all
./build-ca # generate the master Certificate Authority (CA) certificate and key

./build-key-server myservername # ä¸ºæœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ªè¯ä¹¦å’Œç§é’¥
cd keys/
cp myservername.crt myservername.key ca.crt dh2048.pem /etc/openvpn/ # copy them to /etc/openvpn

cd /etc/openvpn/easy-rsa/ # åˆ›å»ºå®¢æˆ·ç«¯è¯ä¹¦
./build-key client1

/etc/openvpn/ca.crt
/etc/openvpn/easy-rsa/keys/client1.crt
/etc/openvpn/easy-rsa/keys/client1.key  # å®¢æˆ·ç«¯æ–‡ä»¶

sudo cp /usr/share/doc/openvpn/examples/sample-config-files/server.conf.gz /etc/openvpn/
sudo gzip -d /etc/openvpn/server.conf.gz

ca ca.crt   # Edit /etc/openvpn/server.conf to make sure the following lines are pointing to the certificates and keys you created in the section above.
cert myservername.crt
key myservername.key
dh dh2048.pem
net.ipv4.ip_forward=1

sudo sysctl -p /etc/sysctl.conf

sudo systemctl start openvpn@server
sudo systemctl status openvpn@server

ifconfig tun0

apt-get install openvpn # å®¢æˆ·ç«¯

# å®¢æˆ·ç«¯é»˜è®¤é…ç½®æ–‡ä»¶æ”¾ç½®æœåŠ¡ç«¯é…ç½®æ–‡ä»¶
sudo cp /usr/share/doc/openvpn/examples/sample-config-files/client.conf /etc/openvpn/

openvpn /etc/openvpn/client.ovpn # è¿æ¥
openvpn /etc/openvpn/client.ovpn > /dev/null & # å¦‚æœå¸Œæœ›å¼€æœºå³è‡ªåŠ¨è¿æ¥OpenVPNï¼Œæˆ–è€…æ˜¯VPNå¸¸å¹´åœ¨çº¿ï¼Œå¯ä»¥åŠ å…¥åˆ°/etc/rc.local

client
dev tap
proto tcp-client
remote vpnserver.example.com 1194
resolv-retry infinite
nobind
mute-replay-warnings
redirect-gateway

ca /etc/openvpn/ca.crt
cert /etc/openvpn/client.crt
key /etc/openvpn/client.key

comp-lzo
verb 4

sudo systemctl start openvpn@client
sudo systemctl status  openvpn@client
```

## Client

```sh
sudo add-apt-repository ppa:hzwhuang/ss-qt5
sudo apt-get update
sudo apt-get install shadowsocks-qt5

# Ubuntu
apt-get install python-pip
pip install shadowsocks
```

## [trojan](https://github.com/trojan-gfw/trojan)

An unidentifiable mechanism that helps you bypass GFW. <https://trojan-gfw.github.io/trojan/>

* æ¨¡ä»¿äº†äº’è”ç½‘ä¸Šæœ€å¸¸è§çš„HTTPSåè®®ï¼Œä»¥è¯±éª—GFWè®¤ä¸ºå®ƒå°±æ˜¯HTTPSï¼Œä»è€Œä¸è¢«è¯†åˆ«
* éœ€è¦ä¸€ä¸ªåŸŸåç”¨æ¥åšä¼ªè£… [freenom](linhttps://www.freenom.comk)

```sh
sudo useradd -m -s /bin/bash trojanuser
sudo passwd trojanuser
sudo usermod -G sudo trojanuser
su -l trojanuser

sudo groupadd certusers
sudo useradd -r -M -G certusers trojan
sudo useradd -r -m -G certusers acme

sudo su -l -s /bin/bash acme
curl  https://get.acme.sh | sh
exit
sudo su -l -s /bin/bash acme

export CF_Key="<Your Global API Key>"
export CF_Email="<Your cloudflare account Email>"

acme.sh --issue --dns dns_cf -d <tdom.ml>
acme.sh --install-cert -d <tdom.ml> --key-file /usr/local/etc/certfiles/private.key --fullchain-file /usr/local/etc/certfiles/certificate.crt
acme.sh  --upgrade  --auto-upgrade

chown -R acme:certusers /usr/local/etc/certfiles
chmod -R 750 /usr/local/etc/certfiles
exit

sudo bash -c "$(curl -fsSL https://raw.githubusercontent.com/trojan-gfw/trojan-quickstart/master/trojan-quickstart.sh)"
sudo chown -R trojan:trojan /usr/local/etc/trojan
sudo cp /usr/local/etc/trojan/config.json /usr/local/etc/trojan/config.json.bak
sudo nano /usr/local/etc/trojan/config.json
password
cert
key

# é…ç½®Nginx
# CentOSåå‘ä»£ç†éœ€è¦é…ç½®SELinuxå…è®¸httpdæ¨¡å—å¯ä»¥è”ç½‘ï¼Œå¦åˆ™æœåŠ¡å™¨ä¼šè¿”å›502é”™è¯¯
sudo setsebool -P httpd_can_network_connect true

# æ¥æ”¶æ¥è‡ªTrojançš„æµé‡ï¼Œä¸ä¸Šé¢Trojané…ç½®æ–‡ä»¶å¯¹åº”
server {
    listen 127.0.0.1:80 default_server;

    server_name <tdom.ml>;

    location / {
        proxy_pass https://www.ietf.org;
    }

}
# æ¥æ”¶æ¥è‡ªTrojançš„æµé‡ï¼Œä½†æ˜¯è¿™ä¸ªæµé‡å°è¯•ä½¿ç”¨IPè€Œä¸æ˜¯åŸŸåè®¿é—®æœåŠ¡å™¨ï¼Œæ‰€ä»¥å°†å…¶è®¤ä¸ºæ˜¯å¼‚å¸¸æµé‡ï¼Œå¹¶é‡å®šå‘åˆ°åŸŸå
server {
    listen 127.0.0.1:80;

    server_name <10.10.10.10>;

    return 301 https://<tdom.ml>$request_uri;
}
# æ¥æ”¶é™¤127.0.0.1:80å¤–çš„æ‰€æœ‰80ç«¯å£çš„æµé‡å¹¶é‡å®šå‘åˆ°443ç«¯å£ï¼Œè¿™æ ·ä¾¿å¼€å¯äº†å…¨ç«™httpsï¼Œå¯æœ‰æ•ˆçš„é˜²æ­¢æ¶æ„æ¢æµ‹
server {
    listen 0.0.0.0:80;
    listen [::]:80;

    server_name _;

    return 301 https://$host$request_uri;
}

cd /usr/src && wget https://github.com/trojan-gfw/trojan/releases/download/v1.15.1/trojan-1.15.1-linux-amd64.tar.xz
tar xvf trojan-1.15.1-linux-amd64.tar.xz

# é…ç½®

# trojan service
cat > /etc/systemd/system/trojan.service <<-EOF
[Unit]
Description=trojan
After=network.target

[Service]
Type=simple
PIDFile=/usr/src/trojan/trojan.pid
ExecStart=/usr/src/trojan/trojan -c "/usr/src/trojan/config.json"
ExecReload=/bin/kill -HUP \$MAINPID
Restart=on-failure
RestartSec=1s

[Install]
WantedBy=multi-user.target

EOF

systemctl start|enable trojan

# å¼€å¯è½¬å‘
echo net.ipv4.ip_forward=1 >> /etc/sysctl.conf
sysctl -p

# é…ç½®æœ¬åœ°åœ°å€ä¸è¢«ä»£ç†
# iptables -t nat -N trojan
iptables -t nat -A trojan -d 0.0.0.0/8 -j RETURN
iptables -t nat -A trojan -d 10.0.0.0/8 -j RETURN
iptables -t nat -A trojan -d 127.0.0.0/8 -j RETURN
iptables -t nat -A trojan -d 169.254.0.0/16 -j RETURN
iptables -t nat -A trojan -d 172.16.0.0/12 -j RETURN
iptables -t nat -A trojan -d 192.168.0.0/16 -j RETURN
iptables -t nat -A trojan -d 224.0.0.0/4 -j RETURN
iptables -t nat -A trojan -d 240.0.0.0/4 -j RETURN

# é…ç½®tcpå’Œudpæµé‡è½¬å‘åˆ°trojanå®¢æˆ·ç«¯
iptables -t nat -A trojan -p tcp -j REDIRECT --to-ports 1080
iptables -t nat -A trojan -p udp -j REDIRECT --to-ports 1080
# é…ç½®tcpå’Œudpä½¿ç”¨trojan chainè§„åˆ™
iptables -t nat -A OUTPUT -p tcp -j trojan
iptables -t nat -A OUTPUT -p udp -j trojan

iptables-save > /etc/iptables-rules
iptables-restore < /etc/iptables-rules # æ‰‹åŠ¨åŠ è½½
```

## [clash](https://github.com/Dreamacro/clash):A rule-based tunnel in Go

* `go get -u -v github.com/Dreamacro/clash`
* é…ç½®:ï½€/home/å½“å‰ç”¨æˆ·ID/.config/clash/config.yml`
* è®¿é—®ï¼š<http://clash.razord.top/#/settings>` ç«¯å£å’Œå£ä»¤æŒ‰ymlæ–‡ä»¶ä¸­çš„external-controllerå†…å®¹è¾“å…¥å³å¯

```sh
mv clash-linux-amd64-vx.xx.x clash
chmod +x clash
Country.mmdb # https://github.com/Dreamacro/maxmind-geoip
config.yaml
icon https://raw.githubusercontent.com/Dreamacro/clash/master/docs/logo.png
# /usr/local/clash/

# clash_startup.sh
#!/bin/bash
CLASH_APP_NAME="clash"
CLASH_APP_PATH="/usr/local/clash"
CLASH_CONFIG_PATH="/usr/local/clash"
CLASH_LOG_PATH="/usr/local/clash/log"
LOG_DATE=$(date +'%Y%m%d')
CHECK_CLASH_PID=$(ps aux | grep "./$CLASH_APP_NAME -d $CLASH_CONFIG_PATH" | grep -v grep | awk '{print $2}')

mkdir -p $CLASH_LOG_PATH

LOG_NUM=$(ls -lR $CLASH_LOG_PATH | wc -l)
LOG_NUM_MAX=15

if [ -n "$CHECK_CLASH_PID" ]; then
    for clash_pid in $CHECK_CLASH_PID; do
        kill -9 $clash_pid
    done
fi

cd $CLASH_APP_PATH && nohup ./$CLASH_APP_NAME -d $CLASH_CONFIG_PATH 2>&1 >>$CLASH_LOG_PATH/$CLASH_APP_NAME-$LOG_DATE.log &

if [ $LOG_NUM -gt $LOG_NUM_MAX ]; then
    for i in $(seq 1 $(($LOG_NUM-$LOG_NUM_MAX))); do
        log_old=$(ls $CLASH_LOG_PATH | sort -n | head -1)
        rm -f $CLASH_LOG_PATH/$log_old
    done
fi

chmod +x clash_startup.sh

# /usr/share/applications/clash.desktop
[Desktop Entry]
Version=1.0
Name=Clash
GenericName=Clash
Comment=A rule-based tunnel in Go
Exec=/usr/local/clash/clash_startup.sh
Terminal=false
Icon=/usr/local/clash/logo.png
Type=Application
Categories=Network

# ç³»ç»Ÿè®¾ç½® -> ç½‘ç»œ -> ç½‘ç»œä»£ç† -> æ‰‹åŠ¨ ï¼Œè®¾ç½®ä¸ºå¦‚ä¸‹å€¼
HTTP ä»£ç† 127.0.0.1 7890
HTTPS ä»£ç† 127.0.0.1 7890
Socks ä¸»æœº 127.0.0.1 7891
```

## [WireGuard](../network/WireGuard.md)

## æœåŠ¡

* [streisand](https://github.com/StreisandEffect/streisand):Streisand sets up a new server running L2TP/IPsec, OpenConnect, OpenSSH, OpenVPN, Shadowsocks, sslh, Stunnel, a Tor bridge, and WireGuard. It also generates custom instructions for all of these services. At the end of the run you are given an HTML file with instructions that can be shared with friends, family members, and fellow activists.
* [trailofbits/algo](https://github.com/trailofbits/algo):Set up a personal IPSEC VPN in the cloud
* ä¸‰æ–¹
  - blinkload
  - å¿«è¿

## å·¥å…·

* [Lantern](https://github.com/getlantern/lantern)
* [firefly-proxy](https://github.com/yinghuocho/firefly-proxy):A proxy software to help circumventing the Great Firewall.
* [XX-Net](https://github.com/XX-net/XX-Net):A proxy tool to bypass GFW.
  - [ä¸­æ–‡æ–‡æ¡£](https://github.com/XX-net/XX-Net/wiki/%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3)
* [googlehosts](https://github.com/googlehosts/hosts) <https://scaffrey.coding.net/p/hosts/git> / <https://git.qvq.network/googlehosts/hosts>
* [new-pac](https://github.com/Alvin9999/new-pac)
* BT sync
* [shadowsocksr-native](https://github.com/ShadowsocksR-Live/shadowsocksr-native):ä»å®¹ç¿»è¶Šå…šå›½æ•æ„Ÿæ—¥ ShadowsocksR (SSR) native implementation for all platforms powered by libuv, GFW terminator
* [Diode](https://support.diode.io/article/ss32engxlq)ä»¥å°†æœ¬æœºï¼ˆlocalhostï¼‰çš„ç½‘ç«™å…¬å¼€åˆ°äº’è”ç½‘ä¸Šï¼Œæä¾›ä¸€ä¸ªäºŒçº§åŸŸåï¼Œä½¿å¾—å¤–éƒ¨ç”¨æˆ·å¯ä»¥è®¿é—®

## å®¢æˆ·ç«¯

* [electron-ssr](https://github.com/erguotou520/electron-ssr)
* [Qv2ray](https://github.com/Qv2ray/Qv2ray):ğŸŒŸ V2Ray/Trojan-GFW/SSR Linux/Windows/macOS è·¨å¹³å° GUI ğŸ”¨ ä½¿ç”¨ C++17/Qt5 ï¼Œæ”¯æŒè®¢é˜…ï¼Œæ‰«æäºŒç»´ç ï¼Œè‡ªå®šä¹‰è·¯ç”±ç¼–è¾‘ ğŸŒŸ <https://qv2ray.github.io>
  - `snap install qv2ray`
* [mellow](https://github.com/mellow-io/mellow):Mellow is a rule-based global transparent proxy client for Windows, macOS and Linux.
* [Surge](https://www.nssurge.com/) <https://www.newlearner.site/2018/08/29/surge-for-mac.html>
* V2rayNG
* [V2rayU](https://github.com/yanue/V2rayU) åŸºäºv2rayæ ¸å¿ƒçš„macç‰ˆå®¢æˆ·ç«¯,ç”¨äºç§‘å­¦ä¸Šç½‘,ä½¿ç”¨swiftç¼–å†™,æ”¯æŒvmess,shadowsocks,socks5ç­‰æœåŠ¡åè®®,æ”¯æŒè®¢é˜…,æ”¯æŒäºŒç»´ç ,å‰ªè´´æ¿å¯¼å…¥,æ‰‹åŠ¨é…ç½®,äºŒç»´ç åˆ†äº«ç­‰ <https://github.com/yanue/V2rayU>
* [Trojan-Qt5](https://github.com/TheWanderingCoel/Trojan-Qt5)
* app
  - shadowrocket
  - [Potatso lite](https://itunes.apple.com/us/app/potatso-lite/id1239860606)
  - Quantumult
    + åˆ†æµ
      * `https://raw.githubusercontent.com/limbopro/Profiles/master/Quantumult/Pro.conf`
      * é“¾æ¥é˜»æ­¢ `https://raw.githubusercontent.com/limbopro/Profiles/master/Quantumult/Rejection.conf`
      * `HOST-SUFFIX,apoll.m.taobao.com,REJECT` è¿™æ˜¯ä¸€æ¡åˆ†æµè§„åˆ™ç¤ºä¾‹ï¼šå³åŒ…å«å…³é”®å­—ä¸ºapoll.m.taobao.comçš„åŸŸåå‡æ‹’ç»ï¼›åˆ†æµè§„åˆ™æ˜¯è¦é…åˆç­–ç•¥ä½¿ç”¨çš„ï¼›å¯ä»¥æŒ‡å®šä»»æ„ç½‘ç«™å¦‚apoll.m.taobao.comæ˜¯èµ°ç›´è¿ï¼ˆDdirectï¼‰è¿˜æ˜¯èµ°ä»£ç†ï¼ˆProxyï¼‰æˆ–è€…å¹²è„†æ‹’ç»ï¼ˆRejectï¼‰è¿æ¥ç½‘ç»œ
    + åŒ¹é…è§„åˆ™
      * HOST ï¼ˆå®Œæ•´åŸŸååŒ¹é…ï¼Œä¸¾ä¾‹limbopro.xyzï¼‰
      * HOST-SUFFIXï¼ˆåŸŸååç¼€åŒ¹é…ï¼‰
      * HOST-KEYWORDï¼ˆåŸŸåå…³é”®å­—åŒ¹é…ï¼Œä¸¾ä¾‹limbopproï¼‰
      * USER-AGENTï¼ˆæµè§ˆå™¨ç”¨æˆ·ä»£ç†åŒ¹é…ï¼Œä¸¾ä¾‹*abc?ï¼‰
      * IP-CIDRï¼ˆæ— ç±»åˆ«åŸŸé—´è·¯ç”±ä¾‹å¦‚192.168.xxï¼‰
      * GEOIPï¼ˆGeoIPæ•°æ®åº“IPåŒ¹é…ï¼Œå‚æ•°å¡«USï¼Œåˆ™ä¸ºç¾å›½ ip æ•°æ®åº“åŒ¹é…ï¼Œæ‰€æœ‰ç¾å›½IPåŒ¹é…è¯¥è§„åˆ™åˆ™æ‰§è¡Œï¼‰

## [ç§‘å­¦ç½‘ä¸Š](https://github.com/haoel/haoel.github.io)

* CN2 GIA + é¦™æ¸¯æœºæˆ¿
* [gost](https://github.com/ginuerzh/gost):GO Simple Tunnel - a simple tunnel written in golang
  - å¯ä»¥è®¾ç½®æˆ HTTPS ä»£ç†ï¼Œç„¶åæŠŠä½ çš„æœåŠ¡ä¼ªè£…æˆä¸€ä¸ªWebæœåŠ¡å™¨ï¼Œæ¯”å…¶å®ƒçš„æµé‡ä¼ªè£…æ›´å¥½ï¼Œä¹Ÿæ›´éšè”½ã€‚è¿™ä¹Ÿæ˜¯è¿™é‡Œå¼ºçƒˆæ¨èçš„ä¸€ä¸ªæ–¹å¼
  - [wiki](https://docs.ginuerzh.xyz/gost/)

```sh
gost -L=:8080 -F=quic://192.168.1.1:8081 -F=socks5+wss://192.168.1.2:8082 -F=http2://192.168.1.3:8083

curl -v "https://www.google.com" --proxy "https://arsenal.bluebird89.online:19007" --proxy-user 'bluebird89:2007006018aC&'
```

## å‚è€ƒ

* [love-gfw](https://github.com/yangchuansheng/love-gfw):ğŸ”¥ä»¥ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ä¸ºæŒ‡å¯¼æ€æƒ³ï¼Œå®ç° Linux å’Œ MacOS è®¾å¤‡çš„å…¨å±€æ™ºèƒ½åˆ†æµ <https://fuckcloudnative.io/posts/linux-circumvent/>
* [gfwlist](https://github.com/gfwlist/gfwlist):The one and only one gfwlist here
* [trojan-gfw](https://github.com/trojan-gfw/trojan):An unidentifiable mechanism that helps you bypass GFW. <https://trojan-gfw.github.io/trojan/>
* [](https://github.com/freefq/free)
* [freess](https://github.com/max2max/freess)
* [ShadowsocksBio](https://github.com/JadaGates/ShadowsocksBio):SSçš„å‰ä¸–ä»Šç”Ÿ
* [w3-goto-world](https://github.com/hoochanlon/w3-goto-world):tomatoGit/AWS/Google é•œåƒ ,SS/SSR/VMESSèŠ‚ç‚¹,WireGuard,IPFS,DeepWeb,Capitalism çŸ¥è¯†å‚¨å¤‡åº“
* [Linuxå…¨å±€æ™ºèƒ½åˆ†æµæ–¹æ¡ˆ](https://fuckcloudnative.io/posts/linux-circumvent/)
* [](https://git.zx2c4.com/)
