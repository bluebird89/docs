# APIï¼ˆApplication Programming Interface) åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£

ä¸€äº›é¢„å…ˆå®šä¹‰çš„å‡½æ•°æˆ–è€…æ¥å£ï¼Œç›®çš„æ˜¯æä¾›åº”ç”¨ç¨‹åºä¸å¼€å‘äººå‘˜åŸºäºæŸè½¯ä»¶æˆ–ç¡¬ä»¶å¾—ä»¥è®¿é—®ä¸€ç»„ä¾‹ç¨‹çš„èƒ½åŠ›ï¼Œè€Œåˆæ— é¡»è®¿é—®æºç ï¼Œæˆ–ç†è§£å†…éƒ¨å·¥ä½œæœºåˆ¶çš„ç»†èŠ‚

* A well defined pipeline to process requests
* REST API done right (methods, status code and headers)
* Validation made easy
* Security beared in mind
* Policy based request throttling
* Easy to add new APIs
* Easy to document and test
* Introspection
    - API ç³»ç»Ÿè‡ªåŠ¨æ”¶é›† metricsï¼Œè‡ªæˆ‘ç›‘æ§
    - æ— è®ºæ˜¯æ’°å†™è€…ï¼Œè¿˜æ˜¯è°ƒç”¨è€…ï¼Œéƒ½å¾ˆå¾ˆæ–¹ä¾¿çš„è·å–æƒ³è¦è·å–çš„ä¿¡æ¯

## çŠ¶æ€

* å‰åç«¯åˆ†ç¦»ï¼Œä¸šç•Œå¹¿æ³›é‡‡ç”¨tokenæ–¹å¼
* åŠ¨æ€ä»¤ç‰Œ
  - OTPï¼šOne-Time Password ä¸€æ¬¡æ€§å¯†ç 
  - HOTPï¼šHMAC-based One-Time Password åŸºäºHMACç®—æ³•åŠ å¯†çš„ä¸€æ¬¡æ€§å¯†ç 
  - TOTPï¼šTime-based One-Time Password åŸºäºæ—¶é—´æˆ³ç®—æ³•çš„ä¸€æ¬¡æ€§å¯†ç 
* åˆå§‹
    - ç¬¬ä¸€æ¬¡æ¥ç™»è®°çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨æ ¹æ®ç”¨æˆ·å‡ºå…·ä¿¡æ¯ï¼Œåœ¨æ ¸éªŒå®Œæ¯•èº«ä»½è¯åï¼ˆéªŒè¯å¯†ç ï¼‰åï¼Œå‘æ”¾token
    - å®¢æˆ·ç«¯ä¿å­˜token,åé¢è®¿é—®æ¥å£æ—¶å¸¦ä¸Štoken
    - token åŠ æœ‰æ•ˆæœŸ
        + é€šè¿‡æŠ“åŒ…ç­‰æ–¹å¼å¾—çŸ¥äº†æœåŠ¡å™¨APIçš„åœ°å€ï¼Œå°±æ„å‘³ç€å¯ä»¥ä»»æ„è°ƒç”¨APIäº†ï¼ŒAPIä¼šè¢«ç›—ç”¨ã€‚ä¸ºäº†é¿å…è¿™ç§è¢«ç›—ç”¨ï¼Œå¼•å…¥ç­¾åæœºåˆ¶
* ç­¾åæœºåˆ¶ï¼šé‡‡å–å¤šæ•°æ®é¡¹ã€ç”¨md5æˆ–è€…sha1
    - å›ºå®šå­—ç¬¦ä¸²ï¼Œæˆ–æœ‰è§„å¾‹å­—ç¬¦ä¸²ã€‚å¦‚æœå®¢æˆ·ç«¯è¢«åç¼–è¯‘äº†ï¼Œç­¾åæœºåˆ¶å°±ä¼šè¢«äººå¾—çŸ¥ã€‚æ‰€ä»¥ï¼Œå¼•å…¥å¦å¤–ä¸€ä¸ªæ–°çš„é‡è¦å…ƒç´ ï¼šæ—¶é—´æˆ³
    - æ—¶é—´æˆ³
        + åˆ¤å®šAPIè®¿é—®çš„æ—¶æ•ˆæ€§
        + å‚ä¸ç­¾åè¿ç®—
    + è€ƒè™‘
        + å¯å˜æ€§ï¼šæ¯æ¬¡çš„ç­¾åå¿…é¡»æ˜¯ä¸ä¸€æ ·çš„
        + æ—¶æ•ˆæ€§ï¼šæ¯æ¬¡è¯·æ±‚çš„æ—¶æ•ˆæ€§ï¼Œè¿‡æœŸä½œåºŸ
        + å”¯ä¸€æ€§ï¼šæ¯æ¬¡çš„ç­¾åæ˜¯å”¯ä¸€çš„
        + å®Œæ•´æ€§ï¼šèƒ½å¤Ÿå¯¹ä¼ å…¥æ•°æ®è¿›è¡ŒéªŒè¯ï¼Œé˜²æ­¢ç¯¡æ”¹
    - æ–¹æ³•
        + å‘é€æ–¹å’Œæ¥æ”¶æ–¹çº¦å®šä¸€ä¸ªåŠ å¯†çš„ç›å€¼ï¼Œè¿›è¡Œç”Ÿæˆç­¾å `/api/login?username=xxx&password=xxx&sign=xxx`
        + å•å‘æ•£åˆ—åŠ å¯†ï¼šæŠŠä»»æ„é•¿çš„è¾“å…¥ä¸²å˜åŒ–æˆå›ºå®šé•¿çš„è¾“å‡ºä¸²ï¼Œå¹¶ä¸”ç”±è¾“å‡ºä¸²éš¾ä»¥å¾—åˆ°è¾“å…¥ä¸²
            * ç®—æ³•ï¼šMD5 SHA MAC CRC
            * ä¼˜ç‚¹
                - æ–¹ä¾¿å­˜å‚¨ï¼šåŠ å¯†åéƒ½æ˜¯å›ºå®šå¤§å°ï¼ˆ32ä½ï¼‰çš„å­—ç¬¦ä¸²ï¼Œèƒ½å¤Ÿåˆ†é…å›ºå®šå¤§å°çš„ç©ºé—´å­˜å‚¨ã€‚
                - æŸè€—ä½ï¼šåŠ å¯†/åŠ å¯†å¯¹äºæ€§èƒ½çš„æŸè€—å¾®ä¹å…¶å¾®ã€‚
                - æ–‡ä»¶åŠ å¯†ï¼šåªéœ€è¦32ä½å­—ç¬¦ä¸²å°±èƒ½å¯¹ä¸€ä¸ªå·¨å¤§çš„æ–‡ä»¶éªŒè¯å…¶å®Œæ•´æ€§ã€‚
                - ä¸å¯é€†ï¼šå¤§å¤šæ•°çš„æƒ…å†µä¸‹ä¸å¯é€†ï¼Œå…·æœ‰è‰¯å¥½çš„å®‰å…¨æ€§
            * ç¼ºç‚¹ï¼šå­˜åœ¨æš´åŠ›ç ´è§£çš„å¯èƒ½æ€§ï¼Œæœ€å¥½é€šè¿‡åŠ ç›å€¼çš„æ–¹å¼æé«˜å®‰å…¨æ€§ã€‚
            * åœºæ™¯ï¼šç”¨äºæ•æ„Ÿæ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·å¯†ç ï¼Œè¯·æ±‚å‚æ•°ï¼Œæ–‡ä»¶åŠ å¯†ç­‰ã€‚
            * æ¨èï¼špassword_hashï¼ˆï¼‰
        + å¯¹ç§°åŠ å¯†:åŒä¸€ä¸ªå¯†é’¥å¯ä»¥åŒæ—¶ç”¨ä½œæ•°æ®çš„åŠ å¯†å’Œè§£å¯†
            * ç®—æ³•ï¼šDESï¼ˆAES æ˜¯ DES çš„å‡çº§ç‰ˆï¼Œå¯†é’¥é•¿åº¦æ›´é•¿ï¼Œé€‰æ‹©æ›´å¤šï¼Œä¹Ÿæ›´çµæ´»ï¼Œå®‰å…¨æ€§æ›´é«˜ï¼Œé€Ÿåº¦æ›´å¿«ï¼‰ AES
            * ä¼˜ç‚¹ï¼šç®—æ³•å…¬å¼€ã€è®¡ç®—é‡å°ã€åŠ å¯†é€Ÿåº¦å¿«ã€åŠ å¯†æ•ˆç‡é«˜ã€‚
            * ç¼ºç‚¹ï¼šå‘é€æ–¹å’Œæ¥æ”¶æ–¹å¿…é¡»å•†å®šå¥½å¯†é’¥ï¼Œç„¶åä½¿åŒæ–¹éƒ½èƒ½ä¿å­˜å¥½å¯†é’¥ï¼Œå¯†é’¥ç®¡ç†æˆä¸ºåŒæ–¹çš„è´Ÿæ‹…ã€‚
            * åº”ç”¨åœºæ™¯ ç›¸å¯¹å¤§ä¸€ç‚¹çš„æ•°æ®é‡æˆ–å…³é”®æ•°æ®çš„åŠ å¯†ã€‚
            * mcrypt_encrypt å’Œ mcrypt_decryptåœ¨ PHP7.2 ç‰ˆæœ¬ä¸­å·²ç»è¢«å¼ƒç”¨äº†ï¼Œåœ¨æ–°ç‰ˆæœ¬ä¸­ä½¿ç”¨ openssl_encrypt å’Œ openssl_decrypt ä¸¤ä¸ªæ–¹æ³•
        + éå¯¹ç§°åŠ å¯†:éœ€è¦ä¸¤ä¸ªå¯†é’¥æ¥è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ï¼Œè¿™ä¸¤ä¸ªç§˜é’¥åˆ†åˆ«æ˜¯å…¬é’¥ï¼ˆpublic keyï¼‰å’Œç§é’¥ï¼ˆprivate keyï¼‰
            * ç®—æ³•
                - RSA2  SHA256WithRSA   å¼ºåˆ¶è¦æ±‚RSAå¯†é’¥çš„é•¿åº¦è‡³å°‘ä¸º2048
                - RSA SHA1WithRSA å¯¹RSAå¯†é’¥çš„é•¿åº¦ä¸é™åˆ¶ï¼Œæ¨èä½¿ç”¨2048ä½ä»¥ä¸Š
            * ä¼˜ç‚¹ ä¸å¯¹ç§°åŠ å¯†ç›¸æ¯”ï¼Œå®‰å…¨æ€§æ›´å¥½ï¼ŒåŠ è§£å¯†éœ€è¦ä¸åŒçš„å¯†é’¥ï¼Œå…¬é’¥å’Œç§é’¥éƒ½å¯è¿›è¡Œç›¸äº’çš„åŠ è§£å¯†ã€‚
            * ç¼ºç‚¹ åŠ å¯†å’Œè§£å¯†èŠ±è´¹æ—¶é—´é•¿ã€é€Ÿåº¦æ…¢ï¼Œåªé€‚åˆå¯¹å°‘é‡æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚
            * åº”ç”¨åœºæ™¯:é€‚åˆäºå¯¹å®‰å…¨æ€§è¦æ±‚å¾ˆé«˜çš„åœºæ™¯ï¼Œé€‚åˆåŠ å¯†å°‘é‡æ•°æ®ï¼Œæ¯”å¦‚æ”¯ä»˜æ•°æ®ã€ç™»å½•æ•°æ®ç­‰ã€‚
    - å¯†é’¥ï¼š
        + å°†å¯†é’¥è®¾ç½®åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œæ¯æ¬¡ä»ç¯å¢ƒå˜é‡ä¸­åŠ è½½
        + å°†å¯†é’¥å­˜æ”¾åˆ°é…ç½®ä¸­å¿ƒï¼Œç»Ÿä¸€è¿›è¡Œç®¡ç†
        + è®¾ç½®å¯†é’¥æœ‰æ•ˆæœŸï¼Œæ¯”å¦‚ä¸€ä¸ªæœˆè¿›è¡Œé‡ç½®ä¸€æ¬¡
* åªè¦å®¢æˆ·ç«¯è¢«åç¼–è¯‘äº†ï¼ŒåŠ å¯†æ–¹å¼å’Œç­¾åæœºåˆ¶éƒ½ä¼šæš´éœ²å‡ºæ¥ï¼Œæ‰€ä»¥å®‰å…¨æ˜¯éœ€è¦åŒæ–¹é…åˆçš„
* tokenæˆ–è€…aesåŠ è§£å¯†å¯†ç :å»ºè®®èµ°POSTæ–¹å¼ï¼Œä¹Ÿå¯ä»¥å°†è¿™äº›ä¿¡æ¯æ”¾åˆ°http headerä¸­ï¼Œä¹Ÿå¯ä»¥æ”¾åˆ°http bodyä¸­
* Nonce
  - nonce æ˜¯ä¸ªå•è°ƒé€’å¢çš„æ•´æ•°ã€‚å½“æŸä¸ªåæ¥çš„è¯·æ±‚çš„ nonceï¼Œæ¯”ä¸Šä¸€ä¸ªæˆåŠŸæ”¶åˆ°çš„è¯·æ±‚çš„ nouce å°æˆ–è€…ç›¸ç­‰çš„æ—¶å€™ï¼Œä¾¿ä¼šæ‹’ç»è¿™æ¬¡è¯·æ±‚ã€‚è¿™æ ·ä¸€æ¥ï¼Œé‡å¤çš„åŒ…å°±ä¸ä¼šè¢«æ‰§è¡Œä¸¤æ¬¡äº†
  - å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šé˜²æ­¢ä¸­é—´äººæ”»å‡»
    + æ˜¯å› ä¸º nonce çš„åŠ å…¥ï¼Œä½¿å¾—åŠ å¯†åçš„åŒæ ·è®¢å•çš„åŠ å¯†æ–‡æœ¬å®Œå…¨æ··ä¹±
    + ä¼šä½¿å¾—ä¸­é—´äººæ— æ³•é€šè¿‡â€œå‘é€åŒæ ·çš„åŒ…æ¥æ„é€ é‡å¤è®¢å•â€œè¿›è¡Œæ”»å‡»
  - é¢‘ç‡è¾ƒé«˜çš„äº¤æ˜“ä¸­ï¼Œtimestamp å¯èƒ½å°±ä¸æ˜¯é‚£ä¹ˆé€‚åˆ,åç¨‹ or å¼‚æ­¥.ä»£ç å¾ˆå¯èƒ½åœ¨å‘é€çš„æ—¶å€™ï¼Œå¹¶ä¸æ˜¯æŒ‰ç…§ä½ æƒ³è¦çš„é¡ºåºå‘é€ç»™æœåŠ¡å™¨ï¼Œå°±ä¼šå‡ºç° timestamp æ›´å¤§çš„è¯·æ±‚åè€Œæ›´æ—©å‘é€ã€‚å…¶æ¬¡ï¼Œåœ¨ç½‘ç»œä¼ è¾“ä¸­ï¼Œä¸åŒçš„åŒ…ä¹Ÿå¯èƒ½æœ‰å®Œå…¨ä¸åŒçš„æŠµè¾¾é¡ºåºï¼Œè™½ç„¶ä½ å¯ä»¥é€šè¿‡ä¸€äº›ç¼–ç¨‹æŠ€å·§æ¥å®ç°æŒ‰é¡ºåºä¼ è¾“ï¼Œä½†æ˜¯å¦‚æœä½ éœ€è¦å¤šå°æœºå™¨è¿›è¡Œè¾ƒä¸ºé«˜é¢‘çš„äº¤æ˜“ã€‚è€Œä¸”éœ€è¦å¯¹åŒä¸€ä¸ªä»“ä½ï¼ˆåŒä¸€ä¸ª API Keyï¼‰è¿›è¡Œæ“ä½œï¼Œå°±å¯èƒ½ä¼šå˜å¾—æ¯”è¾ƒéº»çƒ¦

```
// ç¬¬ä¸€æ­¥è¯·æ±‚
http.post( 'http://host.com/api/account/login', { "account":"zhengsan", "password":"123456" } ).signature( "api/account/login"+"timestamp" )
http.post( 'http://host.com/api/order/list', { "token" : "abcdefg" } ).signature( 'api/order/list' )

// æœåŠ¡ç«¯éªŒè¯å¯†ç å¹¶è¿”å›token
client_timestamp = get_post( 'timestamp' )
if( server_timestamp - cilent_timestamp > 30 ){
  return 'è¿‡æœŸAPIè®¿é—®'
}
server_signature = md5( 'api/account/login' )
client_signature = http.get_post( 'signature' )
if ( server_signature != client_signature ) {
  return 'signature error';
}

password = get_post( 'password' )
account = get_post( 'account' )
server_password = get_password_by_account( 'account' )
if( password == server_password ){
  // ç”Ÿæˆä¸€ä¸ªAESåŠ å¯†å¯†ç 
  enc_password = "1a2b3c4d5f6g7h8i9j0k"
  // ç”ŸæˆåŸå§‹çš„token
  token = "0k9j8h7i6g5f4c3b2c1az9y8x7"
  // æœåŠ¡ç«¯è®°å½•tokenä¸uidå¯¹åº”å…³ç³»
  set( token, uid )
  // æœ€åä¸€æ­¥å¾ˆé‡è¦ï¼Œè¦å°†aesåŠ å¯†å¯†ç  å’Œ tokenè¿”å›ç»™å®¢æˆ·ç«¯
  return enc_password,token
}

// ç¬¬ä¸‰æ­¥ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°ç™»å½•åçš„æ•°æ®ï¼šåŠ è§£å¯†å¯†ç  å’Œ tokenï¼Œç„¶åä¿å­˜èµ·æ¥
token = get( 'token' )
enc_password = get('enc_password')
// å°†è¿™ä¸¤é¡¹ä¿å­˜èµ·æ¥
save( token, enc_password )
// å…ˆå¯¹é“¶è¡Œå¡å·è¿›è¡ŒåŠ å¯†ï¼Œç„¶åå†è¿›è¡Œæäº¤
bank_card = '666777888999'
enc_bank_card = encrypt( enc_password, bank_card )
http.post( "http://host.com/api/bankcard/create", { enc_bank_card, enc_password, token } ).signature( 'api/bankcard/create'+timestamp )

// ç¬¬å››æ­¥ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°æ•°æ®åï¼ŒéªŒè¯APIç­¾åå’Œtimestampæ—¶æ•ˆæ€§ï¼Œæœ€åè§£å¯†æ•°æ®ï¼Œå…¥åº“
// éªŒè¯signatureå’Œtimestampæ—¶æ•ˆæ€§
// è·å–å®¢æˆ·ç«¯ä¼ æ¥çš„token enc_bankcard enc_password
token = get_post( 'token' )
enc_bankcard = get( 'enc_bankcard' )
enc_password = get( 'enc_password' )
bankcard = decrypt( enc_password, enc_bankcard )
// æ ¹æ®å¯¹åº”å…³ç³»ï¼Œç”¨tokenæ‰¾åˆ°uid
uid = get_uid_by_token( 'token' )
// å°†uidå’Œbankcardå…¥åº“
save( uid, bankcard )

openssl genrsa - out private_key . pem 2048
openssl rsa - in private_key . pem - pubout - out public_key . pem
```

## è®¤è¯ã€æˆæƒå’Œå‡­è¯

* API æ˜¯æ— çŠ¶æ€çš„ï¼Œä¸æ¨èä½¿ç”¨ Cookie
    - ä½¿ç”¨ cookieï¼Œä¾‹å¦‚ web é¡¹ç›®ä¸­ ajax çš„æ–¹å¼
    - ä½¿ç”¨ session ID æˆ– hash ä½œä¸º tokenï¼Œä½†å°† token æ”¾å…¥ header ä¸­ä¼ é€’
    - å°†ç”Ÿæˆçš„ token ï¼ˆå¯èƒ½æ˜¯JWTï¼‰æ”¾å…¥ cookie ä¼ é€’ï¼Œåˆ©ç”¨ HTTPonly å’Œ Secure æ ‡ç­¾ä¿æŠ¤ token
* å®ç°è®¤è¯å’Œæˆæƒçš„åŸºç¡€æ˜¯éœ€è¦ä¸€ç§åª’ä»‹ï¼ˆcredentialsï¼‰æ¥æ ‡è®°è®¿é—®è€…çš„èº«ä»½æˆ–æƒåˆ©
* è®¤è¯ï¼ˆauthenticationï¼‰ï¼šæŒ‡çš„æ˜¯å½“å‰ç”¨æˆ·çš„èº«ä»½ï¼Œå½“ç”¨æˆ·ç™»é™†è¿‡åç³»ç»Ÿä¾¿èƒ½è¿½è¸ªåˆ°ä»–çš„èº«ä»½åšå‡ºç¬¦åˆç›¸åº”ä¸šåŠ¡é€»è¾‘çš„æ“ä½œ
    - å³ä½¿ç”¨æˆ·æ²¡æœ‰ç™»å½•ï¼Œå¤§å¤šæ•°ç³»ç»Ÿä¹Ÿä¼šè¿½è¸ªä»–çš„èº«ä»½ï¼Œåªæ˜¯å½“åšæ¥å®¾æˆ–è€…åŒ¿åç”¨æˆ·æ¥å¤„ç†
    - è®¤è¯æŠ€æœ¯è§£å†³çš„æ˜¯ â€œæˆ‘æ˜¯è°ï¼Ÿâ€çš„é—®é¢˜
    - HTTP Basic Authentication
        + å®¢æˆ·ç«¯
            * å°†ç”¨æˆ·åå’Œå¯†ç ä½¿ç”¨å†’å·è¿æ¥ï¼Œä¾‹å¦‚ username:abc123456
            * ä¸ºäº†é˜²æ­¢ç”¨æˆ·åæˆ–è€…å¯†ç ä¸­å­˜åœ¨è¶…å‡º ASCII ç èŒƒå›´çš„å­—ç¬¦ï¼Œæ¨èä½¿ç”¨UTF-8ç¼–ç 
            * å°†ä¸Šé¢çš„å­—ç¬¦ä¸²ä½¿ç”¨ Base 64 ç¼–ç ï¼Œä¾‹å¦‚ dXNlcm5hbWU6YWJjMTIzNDU2
            * åœ¨ HTTP è¯·æ±‚å¤´ä¸­åŠ å…¥ â€œBasic + ç¼–ç åçš„å­—ç¬¦ä¸²â€ï¼Œå³ï¼šAuthorization: Basic QWxhZGRpbjpPcGVuU2VzYW1l
            * è®¾ç½®åç§°ä¸º Authorization çš„ header å¤´éƒ¨
        + Base64 åªèƒ½ç§°ä¸ºç¼–ç ï¼Œè€Œä¸æ˜¯åŠ å¯† (å®é™…ä¸Šæ— éœ€é…ç½®å¯†åŒ™çš„å®¢æˆ·ç«¯å¹¶æ²¡æœ‰ä»»ä½•å¯é åœ°åŠ å¯†æ–¹å¼ï¼Œæˆ‘ä»¬éƒ½ä¾èµ– TSL åè®®)ã€‚è¿™ç§æ–¹å¼çš„è‡´å‘½å¼±ç‚¹æ˜¯ç¼–ç åçš„å¯†ç å¦‚æœæ˜æ–‡ä¼ è¾“åˆ™å®¹æ˜“åœ¨ç½‘ç»œä¼ è¾“ä¸­æ³„éœ²ï¼Œåœ¨å¯†ç ä¸ä¼šè¿‡æœŸçš„æƒ…å†µä¸‹ï¼Œå¯†ç ä¸€æ—¦æ³„éœ²ï¼Œåªèƒ½é€šè¿‡ä¿®æ”¹å¯†ç çš„æ–¹å¼
    - HMACï¼ˆAK/SKï¼‰è®¤è¯ï¼šå¯¹æ¥ä¸€äº› PASS å¹³å°å’Œæ”¯ä»˜å¹³å°æ—¶ï¼Œä¼šè¦æ±‚æˆ‘ä»¬é¢„å…ˆç”Ÿæˆä¸€ä¸ª access keyï¼ˆAKï¼‰ å’Œ secure keyï¼ˆSKï¼‰ï¼Œç„¶åé€šè¿‡ç­¾åçš„æ–¹å¼å®Œæˆè®¤è¯è¯·æ±‚ï¼Œè¿™ç§æ–¹å¼å¯ä»¥é¿å…ä¼ è¾“ secure keyï¼Œä¸”å¤§å¤šæ•°æƒ…å†µä¸‹ç­¾ååªå…è®¸ä½¿ç”¨ä¸€æ¬¡ï¼Œé¿å…äº†é‡æ”¾æ”»å‡»ã€‚
        + åˆ©ç”¨æ•£åˆ—çš„æ¶ˆæ¯è®¤è¯ç  (Hash-based MessageAuthentication Code) æ¥å®ç°çš„ï¼Œå› æ­¤æœ‰å¾ˆå¤šåœ°æ–¹å« HMAC è®¤è¯ï¼Œå®é™…ä¸Šä¸æ˜¯éå¸¸å‡†ç¡®
        + HMAC åªæ˜¯åˆ©ç”¨å¸¦æœ‰ key å€¼çš„å“ˆå¸Œç®—æ³•ç”Ÿæˆæ¶ˆæ¯æ‘˜è¦ï¼Œåœ¨è®¾è®¡ API æ—¶æœ‰å…·ä½“ä¸åŒçš„å®ç°
            * å®¢æˆ·ç«¯éœ€è¦åœ¨è®¤è¯æœåŠ¡å™¨ä¸­é¢„å…ˆè®¾ç½® access keyï¼ˆAK æˆ–å« app IDï¼‰ å’Œ secure keyï¼ˆSKï¼‰
            * åœ¨è°ƒç”¨ API æ—¶ï¼Œå®¢æˆ·ç«¯éœ€è¦å¯¹å‚æ•°å’Œ access key è¿›è¡Œè‡ªç„¶æ’åºåå¹¶ä½¿ç”¨ secure key è¿›è¡Œç­¾åç”Ÿæˆä¸€ä¸ªé¢å¤–çš„å‚æ•° digest
            * æœåŠ¡å™¨æ ¹æ®é¢„å…ˆè®¾ç½®çš„ secure key è¿›è¡ŒåŒæ ·çš„æ‘˜è¦è®¡ç®—ï¼Œå¹¶è¦æ±‚ç»“æœå®Œå…¨ä¸€è‡´
            * **æ³¨æ„ secure key ä¸èƒ½åœ¨ç½‘ç»œä¸­ä¼ è¾“ï¼Œä»¥åŠåœ¨ä¸å—ä¿¡ä»»çš„ä½ç½®å­˜æ”¾ï¼ˆæµè§ˆå™¨ç­‰ï¼‰**
            * æ¯ä¸€æ¬¡è¯·æ±‚çš„ç­¾åå˜å¾—ç‹¬ä¸€æ— äºŒï¼Œä»è€Œå®ç°é‡æ”¾æ”»å‡»ï¼Œéœ€è¦åœ¨ç­¾åæ—¶æ”¾å…¥ä¸€äº›å¹²æ‰°ä¿¡æ¯
                - è´¨ç–‘/åº”ç­”ç®—æ³•ï¼ˆOCRA: OATH Challenge-Response Algorithmï¼‰
                    + å®¢æˆ·ç«¯å…ˆè¯·æ±‚ä¸€æ¬¡æœåŠ¡å™¨ï¼Œè·å¾—ä¸€ä¸ª 401 æœªè®¤è¯çš„è¿”å›ï¼Œå¹¶å¾—åˆ°ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²ï¼ˆnonceï¼‰
                    + å°† nonce é™„åŠ åˆ°æŒ‰ç…§ä¸Šé¢è¯´åˆ°çš„æ–¹æ³•è¿›è¡Œ HMAC ç­¾åï¼ŒæœåŠ¡å™¨ä½¿ç”¨é¢„å…ˆåˆ†é…çš„ nonce åŒæ ·è¿›è¡Œç­¾åæ ¡éªŒï¼Œè¿™ä¸ª nonce åœ¨æœåŠ¡å™¨åªä¼šè¢«ä½¿ç”¨ä¸€æ¬¡ï¼Œå› æ­¤å¯ä»¥æä¾›å”¯ä¸€çš„æ‘˜è¦ã€‚
                - åŸºäºæ—¶é—´çš„ä¸€æ¬¡æ€§å¯†ç ç®—æ³•ï¼ˆTOTPï¼šTime-based One-time Password Algorithmï¼‰ï¼šé€šè¿‡åŒæ­¥æ—¶é—´çš„æ–¹å¼åå•†åˆ°ä¸€è‡´ï¼Œåœ¨ä¸€å®šçš„æ—¶é—´çª—å£å†…æœ‰æ•ˆï¼ˆ1åˆ†é’Ÿå·¦å³ï¼‰
                    + åœ¨ä¸¤æ­¥éªŒè¯ä¸­è¢«å¤§é‡ä½¿ç”¨ï¼šå®¢æˆ·ç«¯æœåŠ¡å™¨å…±äº«å¯†é’¥ç„¶åæ ¹æ®æ—¶é—´çª—å£èƒ½é€šè¿‡ HMAC ç®—æ³•è®¡ç®—å‡ºä¸€ä¸ªç›¸åŒçš„éªŒè¯ç ã€‚TOTP HMAC-based One-time Password algorithm
* æˆæƒï¼ˆauthorizationï¼‰ï¼šæŒ‡çš„æ˜¯ä»€ä¹ˆæ ·çš„èº«ä»½è¢«å…è®¸è®¿é—®æŸäº›èµ„æºï¼Œåœ¨è·å–åˆ°ç”¨æˆ·èº«ä»½åç»§ç»­æ£€æŸ¥ç”¨æˆ·çš„æƒé™
    - å•ä¸€çš„ç³»ç»Ÿæˆæƒå¾€å¾€æ˜¯ä¼´éšè®¤è¯æ¥å®Œæˆçš„ï¼Œä½†æ˜¯åœ¨å¼€æ”¾ API çš„å¤šç³»ç»Ÿç»“æ„ä¸‹ï¼Œæˆæƒå¯ä»¥ç”±ä¸åŒçš„ç³»ç»Ÿæ¥å®Œæˆï¼Œä¾‹å¦‚ OAuth
    - OAuthï¼ˆå¼€æ”¾æˆæƒï¼‰æ˜¯ä¸€ä¸ªå¼€æ”¾æ ‡å‡†ï¼Œå…è®¸ç”¨æˆ·æˆæƒç¬¬ä¸‰æ–¹ç½‘ç«™è®¿é—®å­˜å‚¨åœ¨å¦å¤–çš„æœåŠ¡æä¾›è€…ä¸Šçš„ä¿¡æ¯ï¼Œè€Œä¸éœ€è¦å°†ç”¨æˆ·åå’Œå¯†ç æä¾›ç»™ç¬¬ä¸‰æ–¹ç½‘ç«™æˆ–åˆ†äº«ä»–ä»¬æ•°æ®çš„æ‰€æœ‰å†…å®¹
        + OAuth æ˜¯ä¸€ä¸ªæˆæƒæ ‡å‡†ï¼Œè€Œä¸æ˜¯è®¤è¯æ ‡å‡†ã€‚æä¾›èµ„æºçš„æœåŠ¡å™¨ä¸éœ€è¦çŸ¥é“ç¡®åˆ‡çš„ç”¨æˆ·èº«ä»½ï¼ˆsessionï¼‰ï¼Œåªéœ€è¦éªŒè¯æˆæƒæœåŠ¡å™¨æˆäºˆçš„æƒé™ï¼ˆtokenï¼‰å³å¯
        + access token è¢«è®¾è®¡ç”¨æ¥å®¢æˆ·ç«¯å’Œèµ„æºæœåŠ¡å™¨ä¹‹é—´äº¤äº’,è¿‡æœŸæ—¶é—´ï¼ˆTTLï¼‰åº”è¯¥å°½é‡çŸ­ï¼Œä»è€Œé¿å…ç”¨æˆ·çš„ access token è¢«å—…æ¢æ”»å‡»
        + refresh token æ˜¯è¢«è®¾è®¡ç”¨æ¥å®¢æˆ·ç«¯å’ŒæˆæƒæœåŠ¡å™¨ä¹‹é—´äº¤äº’ã€‚å¸®åŠ©ç”¨æˆ·ç»´æŠ¤ä¸€ä¸ªè¾ƒé•¿æ—¶é—´çš„çŠ¶æ€ï¼Œé¿å…é¢‘ç¹é‡æ–°æˆæƒ.å®¢æˆ·ç«¯æ‹¿ç€ refresh token å»è·å– access token æ—¶åŒæ—¶éœ€è¦é¢„å…ˆé…ç½®çš„ secure keyï¼Œå®¢æˆ·ç«¯å’ŒæˆæƒæœåŠ¡å™¨ä¹‹å‰å§‹ç»ˆå­˜åœ¨å®‰å…¨çš„è®¤è¯ã€‚
        + OAuth è´Ÿè´£è§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿä¹‹é—´çš„æˆæƒé—®é¢˜ï¼Œå³ä½¿æœ‰æ—¶å€™å®¢æˆ·ç«¯å’Œèµ„æºæœåŠ¡å™¨æˆ–è€…è®¤è¯æœåŠ¡å™¨å­˜åœ¨åŒä¸€å°æœºå™¨ä¸Šã€‚OAuth æ²¡æœ‰è§£å†³è®¤è¯çš„é—®é¢˜ï¼Œä½†æä¾›äº†è‰¯å¥½çš„è®¾è®¡åˆ©äºå’Œç°æœ‰çš„è®¤è¯ç³»ç»Ÿå¯¹æ¥ã€‚
        + Open ID è§£å†³çš„é—®é¢˜æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¹‹é—´èº«ä»½è®¤è¯é—®é¢˜ï¼Œä½¿ç”¨Open ID token èƒ½åœ¨å¤šä¸ªç³»ç»Ÿä¹‹é—´éªŒè¯ç”¨æˆ·ï¼Œä»¥åŠè¿”å›ç”¨æˆ·ä¿¡æ¯ï¼Œå¯ä»¥ç‹¬ç«‹ä½¿ç”¨ï¼Œä¸ OAuth æ²¡æœ‰å…³è”
        + OpenID Connect è§£å†³çš„æ˜¯åœ¨ OAuth è¿™å¥—ä½“ç³»ä¸‹çš„ç”¨æˆ·è®¤è¯é—®é¢˜ï¼Œå®ç°çš„åŸºæœ¬åŸç†æ˜¯å°†ç”¨æˆ·çš„è®¤è¯ä¿¡æ¯ï¼ˆID tokenï¼‰å½“åšèµ„æºå¤„ç†ã€‚åœ¨ OAuth æ¡†æ¶ä¸‹å®Œæˆæˆæƒåï¼Œå†é€šè¿‡ access token è·å–ç”¨æˆ·çš„èº«ä»½
        + å¦‚æœç³»ç»Ÿä¸­éœ€è¦ä¸€å¥—ç‹¬ç«‹çš„è®¤è¯ç³»ç»Ÿï¼Œå¹¶ä¸éœ€è¦å¤šç³»ç»Ÿä¹‹é—´çš„æˆæƒå¯ä»¥ç›´æ¥é‡‡ç”¨ Open IDã€‚å¦‚æœä½¿ç”¨äº† OAuth ä½œä¸ºæˆæƒæ ‡å‡†ï¼Œå¯ä»¥å†é€šè¿‡ OpenID Connect æ¥å®Œæˆç”¨æˆ·çš„è®¤è¯ã€‚
    - ç±»å‹ï¼šgrant_typeï¼šauthorization_code password client_credentials
        + æˆæƒç ï¼ˆauthorization codeï¼‰æ–¹å¼ï¼šå‘ç¬¬ä¸‰æ–¹åº”ç”¨å…ˆç”³è¯·ä¸€ä¸ªæˆæƒç ï¼Œç„¶åå†ç”¨è¯¥ç è·å–ä»¤
            * æµç¨‹:å‰ç«¯è·³è½¬åˆ°ç¬¬ä¸‰æ–¹åº”ç”¨ç™»å½•é“¾æ¥->ç”¨æˆ·ç‚¹å‡»é“¾æ¥è·³è½¬åˆ°ç¬¬ä¸‰æ–¹åº”ç”¨ç™»å½•å¹¶è¿›è¡Œæˆæƒ->å‰ç«¯è·³è½¬åˆ°æ‰€æŒ‡å®šåº”ç”¨å›è°ƒèµ„æºåœ°å€å¹¶ä¼´éšç”¨äºäº¤äº’ AccessToken çš„ Code->åç«¯æ ¹æ®è¯·æ±‚ç¬¬ä¸‰æ–¹åº”ç”¨å¹¶ä½¿ç”¨ Code è·å–è¯¥ç”¨æˆ·çš„ AccessToken->è·å– AccessToken ä¹‹åçš„åº”ç”¨å³å¯è‡ªä¸»çš„ä»ç¬¬ä¸‰æ–¹åº”ç”¨ä¸­è·å–ç”¨æˆ·çš„èµ„æºä¿¡æ¯
            * åº”ç”¨ç™»è®°ï¼šæ³¨å†Œä¸€ä¸ª Application,æ·»åŠ å›è°ƒurl,å¾—åˆ° ClientId å’Œ Client Secret
            * éªŒè¯ access token
                - åœ¨å®Œæˆæˆæƒæµç¨‹åï¼Œèµ„æºæœåŠ¡å™¨å¯ä»¥ä½¿ç”¨ OAuth æœåŠ¡å™¨æä¾›çš„ Introspection æ¥å£æ¥éªŒè¯access tokenï¼ŒOAuthæœåŠ¡å™¨ä¼šè¿”å› access token çš„çŠ¶æ€ä»¥åŠè¿‡æœŸæ—¶é—´ã€‚åœ¨OAuthæ ‡å‡†ä¸­éªŒè¯ token çš„æœ¯è¯­æ˜¯ Introspectionã€‚åŒæ—¶ä¹Ÿéœ€è¦æ³¨æ„ access token æ˜¯ç”¨æˆ·å’Œèµ„æºæœåŠ¡å™¨ä¹‹é—´çš„å‡­è¯ï¼Œä¸æ˜¯èµ„æºæœåŠ¡å™¨å’ŒæˆæƒæœåŠ¡å™¨ä¹‹é—´çš„å‡­è¯ã€‚èµ„æºæœåŠ¡å™¨å’ŒæˆæƒæœåŠ¡å™¨ä¹‹é—´åº”è¯¥ä½¿ç”¨é¢å¤–çš„è®¤è¯ï¼ˆä¾‹å¦‚ Basic è®¤è¯ï¼‰ã€‚
                - ä½¿ç”¨ JWT éªŒè¯ã€‚æˆæƒæœåŠ¡å™¨ä½¿ç”¨ç§é’¥ç­¾å‘ JWT å½¢å¼çš„ access tokenï¼Œèµ„æºæœåŠ¡å™¨éœ€è¦ä½¿ç”¨é¢„å…ˆé…ç½®çš„å…¬é’¥æ ¡éªŒ JWT tokenï¼Œå¹¶å¾—åˆ° token çŠ¶æ€å’Œä¸€äº›è¢«åŒ…å«åœ¨ access token ä¸­ä¿¡æ¯ã€‚å› æ­¤åœ¨ JWT çš„æ–¹æ¡ˆä¸‹ï¼Œèµ„æºæœåŠ¡å™¨å’ŒæˆæƒæœåŠ¡å™¨ä¸å†éœ€è¦é€šä¿¡ï¼Œåœ¨ä¸€äº›åœºæ™¯ä¸‹å¸¦æ¥å·¨å¤§çš„ä¼˜åŠ¿ã€‚åŒæ—¶ JWT ä¹Ÿæœ‰ä¸€äº›å¼±ç‚¹ï¼Œæˆ‘ä¼šåœ¨JWT çš„éƒ¨åˆ†è§£é‡Šã€‚
        + éšè—å¼ï¼ˆimplicitï¼‰ï¼šç›´æ¥å‘å‰ç«¯é¢å‘ä»¤ç‰Œï¼Œè·³å›redirect_uriï¼Œä»¤ç‰Œçš„ä½ç½®æ˜¯ URL é”šç‚¹ï¼ˆfragmentï¼‰ï¼Œè€Œä¸æ˜¯æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆquerystringï¼‰ã€‚å› ä¸º OAuth 2.0 å…è®¸è·³è½¬ç½‘å€æ˜¯ HTTP åè®®ï¼Œå› æ­¤å­˜åœ¨"ä¸­é—´äººæ”»å‡»"çš„é£é™©ï¼Œè€Œæµè§ˆå™¨è·³è½¬æ—¶ï¼Œé”šç‚¹ä¸ä¼šå‘åˆ°æœåŠ¡å™¨ï¼Œå°±å‡å°‘äº†æ³„æ¼ä»¤ç‰Œçš„é£é™©ã€‚
            * ç”¨äºä¸€äº›å®‰å…¨è¦æ±‚ä¸é«˜çš„åœºæ™¯ï¼Œå¹¶ä¸”ä»¤ç‰Œçš„æœ‰æ•ˆæœŸå¿…é¡»éå¸¸çŸ­ï¼Œé€šå¸¸å°±æ˜¯ä¼šè¯æœŸé—´ï¼ˆsessionï¼‰æœ‰æ•ˆï¼Œæµè§ˆå™¨å…³æ‰ï¼Œä»¤ç‰Œå°±å¤±æ•ˆäº†
        + å¯†ç å¼ï¼ˆpasswordï¼‰ï¼šä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç ï¼Œç”³è¯·ä»¤ç‰Œ
            * éªŒè¯èº«ä»½é€šè¿‡åï¼Œç›´æ¥ç»™å‡ºä»¤ç‰Œã€‚æ³¨æ„ï¼Œè¿™æ—¶ä¸éœ€è¦è·³è½¬ï¼Œè€Œæ˜¯æŠŠä»¤ç‰Œæ”¾åœ¨ JSON æ•°æ®é‡Œé¢ï¼Œä½œä¸º HTTP å›åº”ï¼Œå®¢æˆ·ç«¯å› æ­¤æ‹¿åˆ°ä»¤ç‰Œ
        + å‡­è¯å¼ï¼ˆclient credentialsï¼‰ï¼šé€‚ç”¨äºæ²¡æœ‰å‰ç«¯çš„å‘½ä»¤è¡Œåº”ç”¨ï¼Œå³åœ¨å‘½ä»¤è¡Œä¸‹è¯·æ±‚ä»¤ç‰Œ
            * ç»™å‡ºçš„ä»¤ç‰Œï¼Œæ˜¯é’ˆå¯¹ç¬¬ä¸‰æ–¹åº”ç”¨çš„ï¼Œè€Œä¸æ˜¯é’ˆå¯¹ç”¨æˆ·çš„ï¼Œå³æœ‰å¯èƒ½å¤šä¸ªç”¨æˆ·å…±äº«åŒä¸€ä¸ªä»¤ç‰Œ
    - JWT ï¼ˆJSON Web Tokenï¼‰:ä¸€ç§è‡ªåŒ…å«ä»¤ç‰Œï¼Œä»¤ç‰Œç­¾å‘åæ— éœ€ä»æœåŠ¡å™¨å­˜å‚¨ä¸­æ£€æŸ¥æ˜¯å¦åˆæ³•ï¼Œé€šè¿‡è§£æä»¤ç‰Œå°±èƒ½è·å–ä»¤ç‰Œçš„è¿‡æœŸã€æœ‰æ•ˆç­‰ä¿¡æ¯
        + ä»¤ç‰Œä¸ºä¸€æ®µç‚¹åˆ†3æ®µå¼ç»“æ„
            * header json çš„ base64 ç¼–ç ä¸ºä»¤ç‰Œç¬¬ä¸€éƒ¨åˆ†
            * payload json çš„ base64 ç¼–ç ä¸ºä»¤ç‰Œç¬¬äºŒéƒ¨åˆ†
            * æ‹¼è£…ç¬¬ä¸€ã€ç¬¬äºŒéƒ¨åˆ†ç¼–ç åçš„ json ä»¥åŠ secret è¿›è¡Œç­¾åçš„ä»¤ç‰Œçš„ç¬¬ä¸‰éƒ¨åˆ†
        + åªéœ€è¦ç­¾åçš„ secret key å°±èƒ½æ ¡éªŒ JWT ä»¤ç‰Œï¼Œå¦‚æœåœ¨æ¶ˆæ¯ä½“ä¸­åŠ å…¥ç”¨æˆ· IDã€è¿‡æœŸä¿¡æ¯å°±å¯ä»¥å®ç°éªŒè¯ä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆã€è¿‡æœŸäº†ï¼Œæ— éœ€ä»æ•°æ®åº“/ç¼“å­˜ä¸­è¯»å–ä¿¡æ¯
        + ç¬¬ä¸€ã€äºŒéƒ¨åˆ†åªæ˜¯ base64 ç¼–ç ï¼Œè‚‰çœ¼ä¸å¯è¯»ï¼Œä¸åº”å½“å­˜æ”¾æ•æ„Ÿä¿¡æ¯
        + è‡ªåŒ…å«ç‰¹æ€§ï¼Œå¯¼è‡´äº†æ— æ³•è¢«æ’¤å›
* ç­–ç•¥
    - åŸºäºè®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰
    - åŸºäºç”¨æˆ·è§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰

```
{
  ClientId: 'xxxxxxxxx',
  Client Secret: 'xxxxxxxxx',
  redirect: 'xxxxxxxxxxx'
}

å‰ç«¯             åç«¯                       åç«¯          åç«¯
-â€”---------       --------------     -------------     ----------
| Client ID | -->| code + state |-->|access_token |-->| user info |
-----------       --------------     -------------     ----------

# å‰ç«¯è·å– code & state
GET https://github.com/login/oauth/authorize?client_id=your_client_id&redirect_uri=your_callback_url&scope=user&state=random_string
| name | type | description |
| ------------ | ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| client_id | string | ç¬¬ä¸€æ­¥ä¸­æ³¨å†Œå¾—åˆ°çš„ClientID |
| redirect_uri | string | ç¬¬ä¸€æ­¥ä¸­è®¾ç½®çš„å›è°ƒåœ°å€ |
| loin | string | æ¨èç™»å½•çš„ Github è´¦æˆ·ï¼Œä¸€èˆ¬ä¸å¡« |
| scope | string | è¿™ä¸ªå‚æ•°æŒ‡å®šäº†æœ€åèƒ½è·å–åˆ°çš„ä¿¡æ¯ï¼Œå–å€¼èŒƒå›´æœ‰ user å’Œ repo ç­‰ç­‰,é»˜è®¤åŒæ—¶å– user å’Œ repo çš„ä¿¡æ¯ï¼Œè¯¦ç»†å–å€¼èŒƒå›´è§Github æ–‡æ¡£ |
| state | string | ä½ è®¾å®šçš„ä¸€ä¸ªéšæœºå€¼ï¼Œç”¨æ¥é˜²æ­¢ cross-sit æ”»å‡» |
| allow_signup | string | è¿™ä¸ªå‚æ•°æŒ‡å®šæ˜¯å¦å…è®¸ç”¨æˆ·åœ¨è®¤è¯çš„æ—¶å€™æ³¨å†Œ Github è´¦å·ï¼Œé»˜è®¤æ˜¯ true |
## è¦æ±‚ç”¨æˆ·ç™»å½•ï¼Œç„¶åè¯¢é—®æ˜¯å¦åŒæ„ç»™äºˆæˆæƒ
## è·³è½¬åˆ°redirect_uriæŒ‡å®šçš„è·³è½¬ç½‘å€ï¼Œå¹¶ä¸”å¸¦ä¸Šæˆæƒç 
http://localhost:8080/oauth/callback?code=859310e7cecc9196f4af

# åç«¯è·å– access_token
POST https://github.com/login/oauth/access_token

| Name | Type | Description |
| ------------- | ------ | ----------------------------- |
| client_id | string | ç¬¬ä¸€æ­¥ä¸­è·å–åˆ°çš„ ClientID |
| cleint_secret | string | ç¬¬ä¸€æ­¥ä¸­è·å–åˆ°çš„ ClientSecret |
| code | string | ç¬¬äºŒæ­¥ä¸­å‰ç«¯è·å–åˆ°çš„ code |
| redirect_uri | string | ç¬¬ä¸€æ­¥ä¸­è®¾ç½®çš„å›è°ƒåœ°å€ |
| state | string | ç¬¬ä¸€æ­¥ä¸­è®¾ç½®çš„éšæœºå€¼ |
## æ ¹æ®å¤´éƒ¨çš„ Accept çš„å€¼è¿”å›
application/x-www-form-urlencoded
access_token=e72e16c7e42f292c6912e7710c838347ae178b4a&token_type=bearer

application/json
{
  "access_token": "e72e16c7e42f292c6912e7710c838347ae178b4a",
  "scope": "repo,gist",
  "token_type": "bearer"
}

## access_token è·å–ç”¨æˆ·ä¿¡æ¯
curl -H "Authorization: Bearer ACCESS_TOKEN" \
https://api.github.com/user

## æ›´æ–°token
/oauth/token?
  grant_type=refresh_token&
  client_id=CLIENT_ID&
  client_secret=CLIENT_SECRET&
  refresh_token=REFRESH_TOKEN
```

## [JSON API](https://jsonapi.org/format/)

* æœ€æ—©æ¥æºäºEmber Dataï¼ˆEmberæ˜¯ä¸€ä¸ªJavaScriptå‰ç«¯æ¡†æ¶ï¼Œåœ¨æ¡†æ¶ä¸­å®šä¹‰äº†ä¸€ä¸ªé€šç”¨çš„æ•°æ®æ ¼å¼ï¼Œåæ¥è¢«å¹¿æ³›è®¤å¯ï¼‰
* MIME ç±»å‹:JSON APIæ•°æ®æ ¼å¼å·²ç»è¢«IANAæœºæ„æ¥å—äº†æ³¨å†Œï¼Œå› æ­¤å¿…é¡»ä½¿ç”¨application/vnd.api+jsonç±»å‹ã€‚å®¢æˆ·ç«¯è¯·æ±‚å¤´ä¸­Content-Typeåº”è¯¥ä¸ºapplication/vnd.api+jsonï¼Œå¹¶ä¸”åœ¨Acceptä¸­ä¹Ÿå¿…é¡»åŒ…å«application/vnd.api+jsonã€‚å¦‚æœæŒ‡å®šé”™è¯¯æœåŠ¡å™¨åº”è¯¥è¿”å›415æˆ–406çŠ¶æ€ç ã€‚
* æ–‡æ¡£ç»“æ„:åœ¨é¡¶çº§èŠ‚ç‚¹ä½¿ç”¨dataã€errorsã€metaï¼Œæ¥æè¿°æ•°æ®ã€é”™è¯¯ä¿¡æ¯ã€å…ƒä¿¡æ¯ï¼Œæ³¨æ„dataå’Œerrorsåº”è¯¥äº’æ–¥ï¼Œä¸èƒ½å†ä¸€ä¸ªæ–‡æ¡£ä¸­åŒæ—¶å­˜åœ¨
    - å…¸å‹çš„dataçš„å¯¹è±¡æ ¼å¼:æœ‰æ•ˆä¿¡æ¯ä¸€èˆ¬éƒ½æ”¾åœ¨attributesä¸­
        + idæ˜¾è€Œæ˜“è§ä¸ºå”¯ä¸€æ ‡è¯†ï¼Œå¯ä»¥ä¸ºæ•°å­—ä¹Ÿå¯ä»¥ä¸ºhashå­—ç¬¦ä¸²ï¼Œå–å†³äºåç«¯å®ç°
        + type æè¿°æ•°æ®çš„ç±»å‹ï¼Œå¯ä»¥å¯¹åº”ä¸ºæ•°æ®æ¨¡å‹çš„ç±»å
        + attributes ä»£è¡¨èµ„æºçš„å…·ä½“æ•°æ®
        + relationshipsã€linksä¸ºå¯é€‰å±æ€§ï¼Œç”¨æ¥æ”¾ç½®å…³è”æ•°æ®å’Œèµ„æºåœ°å€ç­‰æ•°æ®
    - errorså±æ€§:ä½œä¸ºåˆ—è¡¨å­˜åœ¨ï¼Œå› ä¸ºé’ˆå¯¹æ¯ä¸ªèµ„æºå¯èƒ½å‡ºç°å¤šä¸ªé”™è¯¯ä¿¡æ¯,HTTPçŠ¶æ€ç ä¼šä½¿ç”¨ä¸€ä¸ªé€šç”¨çš„401ï¼Œç„¶åæŠŠå…·ä½“çš„éªŒè¯ä¿¡æ¯åœ¨errorsç»™å‡ºæ¥
        + code
        + åœ¨titleå­—æ®µä¸­ç»™å‡ºé”™è¯¯ä¿¡æ¯
        + å¦‚æœåœ¨æœ¬åœ°æˆ–è€…å¼€å‘ç¯å¢ƒæƒ³æ‰“å‡ºæ›´å¤šçš„è°ƒè¯•å †æ ˆä¿¡æ¯ï¼Œå¯ä»¥å¢åŠ ä¸€ä¸ªdetailå­—æ®µè®©è°ƒè¯•æ›´åŠ æ–¹ä¾¿ã€‚éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œåº”è¯¥åœ¨ç”Ÿäº§ç¯å¢ƒå±è”½éƒ¨åˆ†æ•æ„Ÿä¿¡æ¯ï¼Œdetailå­—æ®µæœ€å¥½åœ¨ç”Ÿäº§ç¯å¢ƒä¸å¯è§ã€‚
* è¿”å›ç 
    - 200 OK 200æ˜¯ä¸€ä¸ªæœ€å¸¸ç”¨çš„çŠ¶æ€ç ç”¨æ¥è¡¨ç¤ºè¯·æ±‚æˆåŠŸï¼Œä¾‹å¦‚GETè¯·æ±‚åˆ°æŸä¸€ä¸ªèµ„æºï¼Œæˆ–è€…æ›´æ–°ã€åˆ é™¤æŸèµ„æºã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ä½¿ç”¨POSTåˆ›å»ºèµ„æºåº”è¯¥è¿”å›201è¡¨ç¤ºæ•°æ®è¢«åˆ›å»ºã€‚
    - 201 Created å¦‚æœå®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªPOSTè¯·æ±‚ï¼Œåœ¨RESTfuléƒ¨åˆ†æˆ‘ä»¬æåˆ°ï¼ŒPOSTä¸ºåˆ›å»ºèµ„æºï¼Œå¦‚æœæœåŠ¡å™¨å¤„ç†æˆåŠŸåº”è¯¥è¿”å›ä¸€ä¸ªåˆ›å»ºæˆåŠŸçš„æ ‡å¿—ï¼Œåœ¨HTTPåè®®ä¸­ï¼Œ201ä¸ºæ–°å»ºæˆåŠŸçš„çŠ¶æ€ã€‚æ–‡æ¡£è§„å®šï¼ŒæœåŠ¡å™¨å¿…é¡»åœ¨dataä¸­è¿”å›idå’Œtypeã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªHTTPçš„è¿”å›ä¾‹å­ï¼š
    - 401 Unauthorized å¦‚æœæœåŠ¡å™¨åœ¨æ£€æŸ¥ç”¨æˆ·è¾“å…¥çš„æ—¶å€™ï¼Œéœ€è¦ä¼ å…¥çš„å‚æ•°ä¸èƒ½æ»¡è¶³æ¡ä»¶ï¼ŒæœåŠ¡å™¨å¯ä»¥ç»™å‡º401é”™è¯¯ï¼Œæ ‡è®°å®¢æˆ·ç«¯é”™è¯¯ï¼Œéœ€è¦å®¢æˆ·ç«¯è‡ªæŸ¥ã€‚
    - 415 Unsupported Media Type å½“æœåŠ¡å™¨åª’ä½“ç±»å‹Content-Typeå’ŒAcceptæŒ‡å®šé”™è¯¯çš„æ—¶å€™ï¼Œåº”è¯¥è¿”å›415ã€‚
    - 403 Forbidden å½“å®¢æˆ·ç«¯è®¿é—®æœªæˆæƒçš„èµ„æºæ—¶ï¼ŒæœåŠ¡å™¨åº”è¯¥è¿”å›403è¦æ±‚ç”¨æˆ·æˆæƒä¿¡æ¯ã€‚
    - 404 Not Found è¿™ä¸ªå¤ªå¸¸è§äº†ï¼Œå½“æŒ‡å®šèµ„æºæ‰¾ä¸åˆ°æ—¶æœåŠ¡å™¨åº”å½“è¿”å›404ã€‚
    - 500 Internal Server Error å½“æœåŠ¡å™¨å‘ç”Ÿä»»ä½•å†…éƒ¨é”™è¯¯æ—¶ï¼Œåº”å½“è¿”å›500ï¼Œå¹¶ç»™å‡ºerrorså­—æ®µï¼Œå¿…è¦çš„æ—¶å€™éœ€è¦è¿”å›é”™è¯¯çš„codeï¼Œä¾¿äºæŸ¥é”™ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œ500é”™è¯¯æ˜¯ä¸ºäº†åŒºåˆ†4XXé”™è¯¯ï¼ŒåŒ…æ‹¬ä»»ä½•æœåŠ¡å™¨å†…éƒ¨æŠ€æœ¯æˆ–è€…ä¸šåŠ¡å¼‚å¸¸éƒ½åº”è¯¥è¿”å›500ã€‚
* HATEOAS(Hypermedia As The Engine Of Application State): åœ¨æ²¡æœ‰æ–‡æ¡£çš„æƒ…å†µä¸‹æ‰¾åˆ°è¿™äº›èµ„æºçš„åœ°å€å‘¢ï¼Œä¸€ç§å¯è¡Œçš„åŠæ³•å°±æ˜¯åœ¨APIçš„è¿”å›ä½“é‡Œé¢åŠ å…¥å¯¼èˆªä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯links
* erlangç¤¾åŒºçš„webmachineæˆ–è€…clojureä¸‹çš„liberator

```json
{
  "data": [{
    "type": "articles",
    "id": "1",
    "attributes": {
      "title": "JSON:API paints my bikeshed!"
    },
    "links": {
      "self": "http://example.com/articles/1"
    },
    "relationships": {
      "author": {
        "links": {
          "self": "http://example.com/articles/1/relationships/author",
          "related": "http://example.com/articles/1/author"
        },
        "data": { "type": "people", "id": "9" }
      },
      "comments": {
        "links": {
          "self": "http://example.com/articles/1/relationships/comments",
          "related": "http://example.com/articles/1/comments"
        },
        "data": [
          { "type": "comments", "id": "5" },
          { "type": "comments", "id": "12" }
        ]
      }
    }
  }],
  "included": [{
    "type": "people",
    "id": "9",
    "attributes": {
      "first-name": "Dan",
      "last-name": "Gebhardt",
      "twitter": "dgeb"
    },
    "links": {
      "self": "http://example.com/people/9"
    }
  }, {
    "type": "comments",
    "id": "5",
    "attributes": {
      "body": "First!"
    },
    "relationships": {
      "author": {
        "data": { "type": "people", "id": "2" }
      }
    },
    "links": {
      "self": "http://example.com/comments/5"
    }
  }, {
    "type": "comments",
    "id": "12",
    "attributes": {
      "body": "I like XML better"
    },
    "relationships": {
      "author": {
        "data": { "type": "people", "id": "9" }
      }
    },
    "links": {
      "self": "http://example.com/comments/12"
    }
  }]
}
```

ç¼–è¯‘æ—¶ã€å’Œã€Œè¿è¡Œæ—¶ã€åˆ†å¼€

## æ¶æ„

* æŠŠ API æ‰§è¡Œè·¯å¾„ä¸Šçš„å„ç§å¤„ç†éƒ½æŠ½è±¡å‡ºæ¥ï¼Œæ”¾åˆ°å…¬å…±è·¯å¾„ï¼ˆæˆ–è€…å«ä¸­é—´ä»¶ï¼Œmiddlewareï¼‰ä¹‹ä¸­ï¼Œä¸º API çš„æ’°å†™è€…æ‰«æ¸…å„ç§éšœç¢ï¼ŒåŒæ—¶èƒ½å¤Ÿä¿ƒä½¿ API æ›´åŠ æ ‡å‡†åŒ–ã€‚
* pipeline ä¸‹çš„ç»„ä»¶
  - throttlingï¼šAPI åº”è¯¥æœ‰æœ€åŸºæœ¬çš„è®¿é—®é€Ÿåº¦çš„æ§åˆ¶ï¼Œæ¯”å¦‚ï¼Œå¯¹åŒä¸€ä¸ªç”¨æˆ·ï¼Œå‘å¸ƒ tweet çš„é€Ÿåº¦ä¸å¯èƒ½è¶…è¿‡ä¸€ä¸ªé˜ˆå€¼ï¼Œæ¯”å¦‚æ¯ç§’é’Ÿ 1 æ¡ï¼ˆå®é™…çš„å¹³å‡é€Ÿåº¦åº”è¯¥è¿œä½äºè¿™ä¸ªï¼‰ã€‚è¶…è¿‡è¿™ä¸ªé€Ÿåº¦ï¼Œå°±æ˜¯æ»¥ç”¨ï¼ˆabuseï¼‰ï¼Œéœ€è¦åˆ¶æ­¢å¹¶è¿”å› 429 Too many requestsã€‚throttling å¯ä»¥ä½¿ç”¨ leaky bucket å®ç°ï¼ˆrestify ç›´æ¥æä¾›ï¼‰ã€‚
  - parser / validationï¼šæ¥ä¸‹æ¥è¦è§£æ HTTP request åŒ…å«çš„ headersï¼Œbody å’Œ URL é‡Œçš„ querystringï¼Œå¹¶å¯¹è§£æå‡ºæ¥çš„ç»“æœè¿›è¡Œ validationã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥å±è”½å¾ˆå¤šæœåŠ¡çš„æ»¥ç”¨ï¼Œå¹¶æå‰ç»ˆæ­¢æœåŠ¡çš„æ‰§è¡Œã€‚æ¯”å¦‚ä½ çš„ API è¦æ±‚è°ƒç”¨è€…å¿…é¡»æä¾› X-Client-Idï¼Œæ²¡æœ‰æä¾›çš„ï¼Œæˆ–è€…æä¾›çš„æ ¼å¼ä¸ç¬¦åˆè¦æ±‚çš„ï¼Œç»Ÿç»Ÿæ‹’ç»ã€‚è¿™ä¸ªæ­¥éª¤éå¸¸é‡è¦ï¼Œå¦‚åŒæˆ‘ä»¬çš„çš®è‚¤ï¼Œå°†è‚®è„çš„ä¸–ç•Œå’Œæˆ‘ä»¬çš„å™¨å®˜éš”ç¦»å¼€æ¥ã€‚
  - ACLï¼šé™¤äº†åŸºæœ¬çš„ throttling å’Œ validation å¤–ï¼Œæ§åˆ¶èµ„æºèƒ½å¦è¢«è®¿é—®çš„å¦ä¸€ä¸ªé€”å¾„æ˜¯ ACLã€‚ç®¡ç†å‘˜åº”è¯¥èƒ½å¤Ÿé…ç½®ä¸€äº›è§„åˆ™ï¼Œè¿™äº›è§„åˆ™èƒ½å¤Ÿè¿›ä¸€æ­¥å°†ä¸åˆæ³• / ä¸åˆè§„çš„è®¿é—®è¿‡æ»¤æ‰ã€‚æ¯”å¦‚è¯´ï¼šè·¯å¾„ä¸º "/topic/19805970" çš„çŸ¥ä¹è¯é¢˜ï¼ŒåŒ—äº¬æ—¶é—´æ™šä¸Š10ç‚¹åˆ°æ¬¡æ—¥æ—©ä¸Š7ç‚¹çš„æ—¶é—´ç«¯ï¼Œå…è®¸åœ¨ä¸­å›½å¤§é™†æ˜¾ç¤ºã€‚è¿™æ ·çš„è§„åˆ™å¯ä»¥æ˜¯ä¸€ä¸ªå¤æ‚çš„è¡¨è¾¾å¼ï¼Œå…¶è§¦å‘æ¡ä»¶ï¼ˆurlï¼‰å¯ä»¥è¢«æ”¾ç½®åœ¨ä¸€ä¸ª bloom filter é‡Œï¼Œæ»¡è¶³ filter çš„ url å†è¿›ä¸€æ­¥åœ¨ hash map é‡Œæ‰¾åˆ°å…¶å¯¹åº”çš„è§„åˆ™è¡¨è¾¾å¼ï¼Œæ±‚è§£å¹¶è¿”å›æ˜¯å¦å…è®¸æ˜¾ç¤ºã€‚è‡³äºä¸€ä¸ªè¯¸å¦‚country = "CN" && time >= 00:00CST && time < 07:00CSTï¼ˆè¿™æ˜¯ä¸€ä¸ªç®¡ç†å‘˜è¾“å…¥çš„è¡¨è¾¾å¼ï¼‰è¿™æ ·çš„è¡¨è¾¾å¼å¦‚ä½•å¤„ç†ï¼Œè¯·ç§»æ­¥ å¦‚ä½•æ„‰å¿«åœ°å†™ä¸ªå°parserã€‚
  - normalizationï¼šé¡¾åæ€ä¹‰ï¼Œè¿™ä¸ªç»„ä»¶çš„ä½œç”¨æ˜¯æŠŠè¯·æ±‚çš„å†…å®¹é¢„å¤„ç†ï¼Œä½¿å…¶ç»Ÿä¸€ã€‚normalization å¯ä»¥è¢«è¿›ä¸€æ­¥åˆ†ä¸ºå¤šä¸ªä¸²è¡Œæ‰§è¡Œçš„ strategyï¼Œæ¯”å¦‚ï¼š
    + paginatorï¼šæŠŠ request é‡Œå’Œ page / sort ç›¸å…³çš„ä¿¡æ¯ç»„åˆèµ·æ¥ï¼Œç”Ÿæˆä¸€ä¸ª paginatorã€‚
    + client adapterï¼šæŠŠ API client èº«ä»½ç›¸å…³çš„ä¿¡æ¯ï¼ˆdevice idï¼Œplatformï¼Œuser idï¼Œsrc ipï¼Œ...ï¼‰ç»„åˆæˆä¸€ä¸ª adapterã€‚
    + input adapterï¼šè¾“å…¥æ•°æ®çš„é€‚é…ã€‚è¿™æ˜¯ä¸ºå¤„å¥³åº§å‡†å¤‡çš„ã€‚å¾ˆå¤šæ—¶å€™ï¼Œè¾“å…¥æ•°æ®çš„æ ¼å¼å’Œè¯­è¨€å¤„ç†æ•°æ®çš„æ ¼å¼ä¸ä¸€æ ·ï¼Œè¿™å¯¹å¤„å¥³åº§ç¨‹åºå‘˜æ˜¯ä¸å¯æ¥å—çš„ã€‚æ¯”å¦‚è¯´ API çš„è¾“å…¥ä¸€èˆ¬æ˜¯ snake caseï¼ˆshow_me_the_moneyï¼‰ï¼Œè€Œåœ¨æŸäº›è¯­è¨€é‡Œé¢ï¼ˆå¦‚: javascriptï¼‰ï¼Œçº¦å®šä¿—æˆçš„å‘½åè§„åˆ™æ˜¯ showMeTheMoneyï¼Œæ‰€ä»¥æŠŠè¾“å…¥çš„åç§°è½¬æ¢æœ‰åˆ©äºå¯¹ä»£ç æœ‰æ´ç™–çš„ç¨‹åºå‘˜ã€‚
  - authenticationï¼šç”¨æˆ·èº«ä»½éªŒè¯ã€‚ä¸»è¦æ˜¯å¤„ç† "Authorization" å¤´ã€‚å¯¹äºä¸éœ€è¦éªŒè¯çš„ APIï¼Œå¯ä»¥è·³è¿‡è¿™ä¸€æ­¥ã€‚åš APIï¼Œèº«ä»½éªŒè¯ä¸€å®šä¸è¦ä½¿ç”¨ cookie/session based authenticationï¼Œè€Œåº”è¯¥ä½¿ç”¨ tokenã€‚ç°æœ‰çš„ token base authentication æœ‰ oauth, jwt ç­‰ã€‚å¦‚æœä½¿ç”¨ jwtï¼Œè¦æ³¨æ„ jwt æ˜¯ stateless çš„ tokenï¼Œä¸€èˆ¬ä¸éœ€è¦æœåŠ¡å™¨å†ä½¿ç”¨æ•°æ®åº“å¯¹ token é‡Œçš„å†…å®¹æ ¡éªŒï¼Œæ‰€ä»¥ä½¿ç”¨ jwt ä¸€å®šè¦ç”¨ https ä¿æŠ¤ tokenï¼Œå¹¶ä¸”è¦è®¾ç½®åˆé€‚çš„è¶…æ—¶æ—¶é—´è®© token è‡ªåŠ¨è¿‡æœŸã€‚
  - authorizationï¼šç”¨æˆ·æœ‰äº†èº«ä»½ä¹‹åï¼Œè¿›ä¸€æ­¥éœ€è¦çŸ¥é“ç”¨æˆ·æœ‰ä»€ä¹ˆæ ·çš„æƒé™è®¿é—®ä»€ä¹ˆæ ·çš„èµ„æºã€‚æ¯”å¦‚ï¼šuid æ˜¯ 9527 çš„ç”¨æˆ·å¯¹ "POST /topic/"ï¼ˆåˆ›å»ºä¸€ä¸ªæ–°çš„è¯é¢˜ï¼‰ï¼Œ"PUT /topic/:id"ï¼ˆä¿®æ”¹å·²æœ‰çš„è¯é¢˜ï¼‰æœ‰è®¿é—®æƒé™ï¼Œå½“ä»–å‘èµ· "DELETE /topic/1234" æ—¶ï¼Œåœ¨ authorization è¿™ä¸€å±‚ç›´æ¥è¢«æ‹’ç»ã€‚authorization æ˜¯å¦ä¸€ç§ ACLï¼ˆrole based ACLï¼‰ï¼Œå¤„ç†æ–¹å¼ä¹Ÿç±»ä¼¼ã€‚
  - conditional requestï¼šåœ¨è®¿é—®çš„å…¥å£å¤„ï¼Œå¦‚æœè®¿é—®æ˜¯ PUT/PATCH è¿™æ ·ä¿®æ”¹å·²æœ‰èµ„æºçš„æ“ä½œï¼Œå¥½çš„ API å®ç°ä¼šè¦æ±‚å®¢æˆ·ç«¯é€šè¿‡ conditional requestï¼ˆif-match / if-modifiedï¼‰åš concurrent controlï¼Œç›®çš„æ˜¯ä¿è¯å®¢æˆ·ç«¯è¦æ›´æ–°æ•°æ®æ—¶ï¼Œå®ƒä½¿ç”¨çš„æ˜¯æœåŠ¡å™¨çš„è¯¥æ•°æ®çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè€ŒéæŸä¸ªå†å²ç‰ˆæœ¬ï¼Œå¦åˆ™è¿”å› 412 precondition failedï¼ˆæ›´å¤šè¯¦æƒ…ï¼Œè¯·å‚è€ƒæˆ‘ä¹‹å‰çš„æ–‡ç«  æ’°å†™åˆæ ¼çš„REST APIï¼‰ã€‚
  - preprocessing hookï¼š
  - processingï¼šAPI æœ¬èº«çš„å¤„ç†ã€‚è¿™ä¸ªä¸€èˆ¬æ˜¯ API ä½œè€…æä¾›çš„å¤„ç†å‡½æ•°ã€‚
  - postprocessingï¼š
  - conditional requestï¼šåœ¨è®¿é—®çš„å‡ºå£å¤„ï¼Œå¦‚æœè®¿é—®çš„æ˜¯ GET è¿™æ ·çš„æ“ä½œï¼Œå¥½çš„ API å®ç°ä¼šæ”¯æŒå®¢æˆ·ç«¯çš„ if-none-match/if-not-modified è¯·æ±‚ã€‚å½“æ¡ä»¶åŒ¹é…ï¼Œè¿”å› 200 OK å’Œç»“æœï¼Œå¦åˆ™ï¼Œè¿”å› 304 Not Modifiedã€‚304 Not Modified å¯¹å®¢æˆ·ç«¯æ¥è¯´å¦‚åŒç‘°å®ï¼Œé™¤äº†èŠ‚çœç½‘ç»œå¸¦å®½ä¹‹å¤–ï¼Œå®¢æˆ·ç«¯ä¸å¿…åˆ·æ–°æ•°æ®ã€‚å¦‚æœä½ çš„ app é‡Œé¢æŸä¸ªç±»åˆ«ä¸‹æœ‰äº”åç¯‡æ–‡ç« ï¼Œä¸‹æ‹‰åˆ·æ–°çš„ç»“æœæ˜¯ 304 Not Modifiedï¼Œå®¢æˆ·ç«¯ä¸å¿…é‡ç»˜è¿™ 50 ç¯‡æ–‡ç« ã€‚å½“ç„¶ï¼Œæœ‰ä¸å°‘ API çš„å®ç°æ˜¯é€šè¿‡è¿”å›çš„æ•°æ®ä¸­çš„ä¸€ä¸ªè‡ªå®šä¹‰çš„çŠ¶æ€ç æ¥å†³å®šï¼Œè¿™å¥½æ¯”ã€Œè„±è£¤å­æ”¾å±ã€â€”â€” æ˜¾å¾—ç´¯èµ˜äº†ã€‚
  - response normalizationï¼šå’Œ request é˜¶æ®µçš„ normalization ç±»ä¼¼ï¼Œåœ¨è¾“å‡ºé˜¶æ®µï¼Œéœ€è¦å°†ç»“æœè½¬æ¢æˆåˆé€‚çš„æ ¼å¼è¿”å›ç»™ç”¨æˆ·ã€‚response normalization ä¹Ÿæœ‰å¾ˆå¤š strategyï¼Œæ¯”å¦‚ï¼š
    + output adapterï¼šå¦‚æœè¯´ input adapter æ˜¯ä¸ºæœ‰æ´ç™–çš„ç¨‹åºå‘˜å‡†å¤‡çš„ï¼Œå¯æœ‰å¯æ— ï¼Œé‚£ä¹ˆ output adapter åˆ™å¹¶éå¦‚æ­¤ã€‚å®ƒèƒ½ä¿æŒè¾“å‡ºæ ¼å¼çš„ä¸€è‡´å’Œç»Ÿä¸€ã€‚æ¯”å¦‚ä½ çš„æ•°æ®åº“é‡Œçš„å­—æ®µæ˜¯ camel caseï¼Œä½ çš„ç¨‹åºä¹Ÿéƒ½æ˜¯ç”¨ camel caseï¼Œç„¶è€Œ API çš„è¾“å‡ºéœ€è¦ç»Ÿä¸€ä¸º snake caseï¼Œé‚£ä¹ˆï¼Œåœ¨ output adapter è¿™ä¸ªé˜¶æ®µç»Ÿä¸€å¤„ç†ä¼šå¥½è¿‡æ¯ä¸ª API è‡ªå·±å¤„ç†ã€‚
    + aliasingï¼šå¾ˆå¤šæ—¶å€™è·å¾—çš„æ•°æ®çš„åç§°å’Œå®šä¹‰å¥½çš„ API çš„æ¥å£çš„åç§°å¹¶ä¸åŒ¹é…ï¼Œå¦‚æœåœ¨æ¯ä¸ª API é‡Œé¢å•ç‹¬å¤„ç†éå¸¸å•°å—¦ã€‚è¿™ç§å¤„ç†å¯ä»¥è¢«æŠ½å–å‡ºæ¥æ”¾åœ¨ normalization çš„é˜¶æ®µå®Œæˆã€‚API çš„æ’°å†™è€…åªéœ€è¦å®šä¹‰åç§° A éœ€è¦è¢« alias æˆ B å°±å¥½ï¼Œå‰©ä¸‹çš„ç”±æ¡†æ¶å¸®ä½ å®Œæˆã€‚
    + partial responseï¼špartial response æ˜¯ google API çš„ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ç‰¹æ€§ï¼ˆè§ï¼šhttps://developers.google.com/+/web/api/rest/#partial-response ï¼‰ï¼Œä»–èƒ½è®©ä½ ä¸æ”¹å˜ API å®ç°çš„æƒ…å†µä¸‹ï¼Œç”±å®¢æˆ·ç«¯æ¥å†³å®šæœåŠ¡å™¨è¿”å›ä»€ä¹ˆæ ·çš„ç»“æœï¼ˆå½“å‰ç»“æœçš„ä¸€ä¸ªå­é›†ï¼‰ï¼Œè¿™éå¸¸æœ‰åˆ©äºèŠ‚çœç½‘ç»œå¸¦å®½ã€‚
  - serializationï¼šå¦‚æœ API æ”¯æŒ content negotiationï¼Œé‚£ä¹ˆæœåŠ¡å™¨åœ¨æœ‰å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œä¼˜å…ˆè¿”å›å®¢æˆ·ç«¯å»ºè®®çš„è¾“å‡ºç±»å‹ã€‚åŒä¸€ä¸ª APIï¼Œandroid å¯ä»¥è®©å®ƒè¿”å› application/msgpackï¼›web å¯ä»¥è®©å®ƒè¿”å› application/jsonï¼Œè€Œ xbox å¯ä»¥è·å¾— application/xml çš„è¿”å›ï¼Œå„å–æ‰€éœ€ã€‚
  - postserializationï¼šè¿™ä¹Ÿæ˜¯ä¸ª hookï¼Œåœ¨æ•°æ®æœ€ç»ˆè¢«å‘é€ç»™å®¢æˆ·ç«¯å‰ï¼ŒAPI è°ƒç”¨è€…å¯ä»¥æœ€åä¸€æ¬¡ inject è‡ªå·±æƒ³è¦çš„é€»è¾‘ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œä¸€äº› API ç³»ç»Ÿå†…éƒ¨çš„ç»Ÿè®¡æ•°æ®å¯ä»¥åœ¨æ­¤æ”¶é›†ï¼ˆæ‰€æœ‰çš„å‡ºé”™å¤„ç†è·¯å¾„å’Œæ­£å¸¸è·¯å¾„éƒ½åœ¨è¿™é‡Œäº¤æ±‡ï¼‰ã€‚

## å­ç³»ç»Ÿ

* é…ç½®ç®¡ç†
  - ä¸€ä¸ªå…¬å…±çš„åœ°æ–¹æ¥æ”¾ç½®é¢„ç½®çš„å±æ€§ã€‚toml
  - é…ç½®æ–‡ä»¶å¯ä»¥é‡è½½ï¼ˆoverrideï¼‰ï¼šç³»ç»Ÿæä¾›ä¸€ä¸ªå…¬å…±çš„é…ç½®æ–‡ä»¶ï¼šdefaultï¼Œç„¶åå„ç§è¿è¡Œæ—¶ç›¸å…³çš„é…ç½®æ–‡ä»¶ç»§æ‰¿å¹¶å±€éƒ¨é‡è½½è¿™ä¸ªé…ç½®ã€‚åœ¨ç³»ç»Ÿå¯åŠ¨çš„æ—¶å€™ï¼ŒäºŒè€…åˆå¹¶ã€‚
  - è¿è¡Œçš„æ—¶å€™æ”¹å†™é…ç½®ï¼šåƒç®¡ç†ç¼“å­˜ä¸€æ ·å»ç®¡ç†å’Œé…ç½®ç›¸å…³çš„æ•°æ®ï¼Œå°†å…¶å°è£…åœ¨ä¸€ä¸ªå®¹å™¨é‡Œï¼šå½“é…ç½®è¢«ä¿®æ”¹æ—¶ï¼Œè°ƒç”¨è¿™ä¸ªå®¹å™¨çš„ invalidate æ–¹æ³• â€”â€” è¿™æ ·ï¼Œä¸‹æ¬¡è®¿é—®ä»»æ„ä¸€ä¸ªé…ç½®é¡¹æ—¶ï¼Œä¼šé‡æ–°è¯»å…¥é…ç½®ï¼Œå¹¶ç¼“å­˜èµ·æ¥
* CLIï¼šä¸æ˜¯ç»™ç”¨æˆ·ç”¨çš„ï¼Œæ˜¯ç»™ç¨‹åºå‘˜ç”¨çš„
  - éš¾ç‚¹
    + CLI çš„å‘ç°å’Œè‡ªæ³¨å†Œã€‚ä½ çš„ framework çš„ç”¨æˆ·åªè¦éµå¾ªæŸç§ convention æ’°å†™ CLIï¼Œè¿™äº› CLI å°±ä¼šè¢«è‡ªåŠ¨é›†æˆåˆ°ç³»ç»Ÿé‡Œã€‚
    + CLI çš„æ’°å†™è€…èƒ½å¤Ÿè½»æ¾åœ°è·å–åˆ°ç³»ç»Ÿçš„ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç³»ç»Ÿæœ‰è‡ªçœï¼ˆintrospectionï¼‰çš„èƒ½åŠ›ã€‚
* æµ‹è¯•æ¡†æ¶
  -  functional testing æ˜¯å¯ä»¥å…¨å±€è€ƒè™‘
  -  ava æè¿°æµ‹è¯•çš„ fixture

## å¥‘çº¦

* ä¸€å¼€å§‹éšæ„äº†ï¼Œç®€å•äº†ï¼Œä¼šç»™ä¹‹åçš„ç»´æŠ¤å’Œæ›´æ–°å¸¦æ¥æ— ç©·æ— å°½çš„ç—›è‹¦
* å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æè¿° API çš„è¾“å…¥è¾“å‡ºï¼Œå¹¶ç”Ÿæˆäº¤äº’å¼çš„ API æ–‡æ¡£ï¼ˆè¯» API æ–‡æ¡£çš„æ—¶å€™ï¼Œå¯ä»¥åœ¨çº¿è¿è¡Œ APIï¼‰ è®¾è®¡å·¥å…·æœ‰
  - swaggerï¼šç¼ºç‚¹æ˜¯å¤ªç¹æ‚ï¼Œæ’°å†™èµ·æ¥å¾ˆéº»çƒ¦
    + é€šè¿‡ä»£ç åå‘ç”Ÿæˆ swagger æ–‡æ¡£
    + å…ˆæ’°å†™ä»£ç æŠŠ API çš„è¾“å…¥è¾“å‡ºå®šä¹‰æ¸…æ¥šï¼Œç„¶åé€šè¿‡è¿™ä¸ªå®šä¹‰æ¥ç”Ÿæˆ swagger æ–‡æ¡£ï¼Œåœ¨ swagger-ui é‡Œé¢è°ƒè¯•å’ŒéªŒè¯ï¼›å½“å€Ÿå£è®¾è®¡ç¬¦åˆæœŸæœ›åï¼Œå†å®Œæˆå…·ä½“çš„å®ç°
  - API blueprintï¼šæ›´åå‘ API çš„æ–‡æ¡£åŒ–ï¼Œæ‰€ä»¥å®ƒé€‰æ‹©çš„æè¿°è¯­è¨€æ˜¯ markdownã€‚validation ç›¸å…³çš„å†…å®¹ç”¨ markdown æè¿°ä¸æ˜¯å¾ˆèˆ’æœï¼Œçœ‹åˆ«äººå†™çš„æ–‡æ¡£å¾ˆå®¹æ˜“æ˜ç™½ï¼Œè‡ªå·±å†™èµ·æ¥å°±ä¼šé”™æ¼ç™¾å‡ºã€‚API blueprint çš„å·¥å…·é“¾ä¹Ÿæ˜¯ä¸ªè–„å¼±ç¯èŠ‚ï¼Œå¾ˆå¤šå·¥å…·éƒ½æ²¡æœ‰æˆ–è€…ä¸æˆç†Ÿ
  - RAML

## æ–‡æ¡£

* æ ¼å¼
    - è¯·æ±‚åœ°å€
    - è¯·æ±‚ç±»å‹
    - å‚æ•°è¯´æ˜
    - è¿”å›ç»“æœè¯´æ˜
* åŸºäºæ³¨é‡Šçš„ API æ–‡æ¡£ï¼šé€šè¿‡ä»£ç ä¸­æ³¨é‡Šç”Ÿæˆ API æ–‡æ¡£çš„è½»é‡çº§æ–¹æ¡ˆ
    - å¥½å¤„æ˜¯ç®€å•æ˜“ç”¨ï¼ŒåŸºæœ¬ä¸ç¼–ç¨‹è¯­è¨€æ— å…³
    - å› ä¸ºåŸºäºæ³¨é‡Šï¼Œéå¸¸é€‚åˆåŠ¨æ€è¯­è¨€çš„æ–‡æ¡£è¾“å‡ºï¼Œä¾‹å¦‚ Nodejsã€PHPã€Pythonã€‚ç”±äºNPMåŒ…å®¹æ˜“å®‰è£…å’Œä½¿ç”¨ï¼Œè¿™é‡Œæ¨è nodejs å¹³å°ä¸‹çš„ apidocjs
* åŸºäºåå°„çš„ API æ–‡æ¡£ï¼šä½¿ç”¨ swagger è¿™ç±»é€šè¿‡åå°„æ¥è§£æä»£ç ï¼Œåªéœ€è¦å®šä¹‰å¥½ Modelï¼Œå¯ä»¥å®ç°è‡ªåŠ¨è¾“å‡º API æ–‡æ¡£ã€‚è¿™ç§æ–¹æ¡ˆé€‚åˆå¼ºç±»å‹è¯­è¨€ä¾‹å¦‚ Javaã€.Netï¼Œå°¤å…¶æ˜¯ç”Ÿæˆä¸€ä»½ç¨³å®šã€èƒ½åœ¨å›¢é˜Ÿå¤–ä½¿ç”¨çš„ API æ–‡æ¡£
    - swagger å®é™…ä¸Šæ˜¯ä¸€æ•´å¥—å…³äº API æ–‡æ¡£ã€ä»£ç ç”Ÿæˆã€æµ‹è¯•ã€æ–‡æ¡£å…±äº«çš„å·¥å…·åŒ…ï¼ŒåŒ…æ‹¬ :
        + Swagger Editor ä½¿ç”¨ swagger editor ç¼–å†™æ–‡æ¡£å®šä¹‰ yml æ–‡ä»¶ï¼Œå¹¶ç”Ÿæˆ swagger çš„ json æ–‡ä»¶,æä¾›çº¿ä¸Šç‰ˆæœ¬ï¼Œä¹Ÿå¯ä»¥æœ¬åœ°ä½¿ç”¨
        + Swagger UI è§£æ swagger çš„ json å¹¶ç”Ÿæˆ html é™æ€æ–‡æ¡£
        + Swagger Codegen å¯ä»¥é€šè¿‡ json æ–‡æ¡£ç”Ÿæˆ Java ç­‰è¯­è¨€é‡Œé¢çš„æ¨¡æ¿æ–‡ä»¶ï¼ˆæ¨¡å‹æ–‡ä»¶ï¼‰
        + Swagger Inspector API è‡ªåŠ¨åŒ–æµ‹è¯•
        + Swagger Hub å…±äº« swagger æ–‡æ¡£
* ä½¿ç”¨å¥‘çº¦è¿›è¡Œå‰åç«¯åä½œï¼šåœ¨å›¢é˜Ÿå†…éƒ¨ï¼Œå‰åç«¯åä½œæœ¬è´¨ä¸Šéœ€è¦çš„ä¸æ˜¯ä¸€ä»½ API æ–‡æ¡£ï¼Œè€Œæ˜¯ä¸€ä¸ªå¯ä»¥ä¾›å‰åç«¯å…±åŒéµå®ˆçš„å¥‘çº¦
    - å‰åç«¯å¯ä»¥ä¸€èµ·åˆ¶å®šä¸€ä»½å¥‘çº¦ï¼Œä½¿ç”¨è¿™ä»½å¥‘çº¦å…±åŒå¼€å‘ï¼Œå‰ç«¯ä½¿ç”¨è¿™ä»½å¥‘çº¦ mock APIï¼Œåç«¯åˆ™å¯ä»¥é€šè¿‡å®ƒç®€å•çš„éªŒè¯APIæ˜¯å¦æ­£ç¡®è¾“å‡º
    - **å¥‘çº¦æµ‹è¯•**:æ¶ˆè´¹è€…é©±åŠ¨çš„å¥‘çº¦  Spring cloud contract
    - åç«¯æ ¹æ®éœ€æ±‚ï¼Œç”Ÿæˆ API å®šä¹‰æ–‡ä»¶ï¼Œå°±å¯ä»¥è¿›ä¸€æ­¥å®Œæˆç”Ÿæˆ HTML é™æ€æ–‡æ¡£ã€æ¨¡æ‹Ÿ API æ•°æ®ç­‰æ“ä½œ
    - å‰ç«¯å¯¹æ¥æ¥å£,é€šè¿‡ swagger çš„ node ç‰ˆæœ¬ swagger-node è‡ªå¸¦çš„ mock æ¨¡å¼å¯åŠ¨ä¸€ä¸ª Mock serverï¼Œç„¶åæ ¹æ®çº¦å®šæ¨¡æ‹Ÿè‡ªå·±æƒ³è¦çš„æ•°æ®, mockjs + rap æˆ–è€… easy-mock
    - ç®¡ç†å¥‘çº¦æ–‡ä»¶:å•ç‹¬å¢åŠ äº†ä¸€ä¸ªç®¡ç†å¥‘çº¦æ–‡ä»¶çš„ gitä»“åº“ï¼Œå¹¶ä½¿ç”¨ git çš„submodule æ¥å¼•ç”¨åˆ°å„ä¸ªæ¶‰åŠåˆ°äº†çš„ä»£ç ä»“åº“ä¸­
        + å•ç‹¬æ”¾ç½®è¿˜æœ‰ä¸€ä¸ªé¢å¤–çš„å¥½å¤„:æ„å»ºå¥‘çº¦æµ‹è¯•æ—¶ï¼Œå¯ä»¥æ–¹ä¾¿çš„å‘é€åˆ°ä¸€å°ä¸­é—´æœåŠ¡å™¨ã€‚ä¸€æ—¦ API å¥‘çº¦å‘ç”Ÿå˜åŒ–ï¼Œå¯ä»¥è§¦å‘ APIæä¾›çš„å¥‘çº¦éªŒè¯æµ‹è¯•
* RAML RestFul API ç»Ÿä¸€å»ºæ¨¡è¯­è¨€ ï¼ˆRESTful API Modeling Languageï¼‰,æ„å»ºå‡º API åä½œçš„å·¥å…·é“¾ï¼Œè®¾è®¡ã€æ„å»ºã€æµ‹è¯•ã€æ–‡æ¡£ã€å…±äº«ã€‚

### [encode/apistar](https://github.com/encode/apistar)

A smart Web API framework, for Python 3. ğŸŒŸ https://docs.apistar.com

* pip3 install apistar
* Create a new project in app.py, python app.py
* Open http://127.0.0.1:5000/docs/ in your browser

```py
from apistar import App, Route

def welcome(name=None):
    if name is None:
        return {'message': 'Welcome to API Star!'}
    return {'message': 'Welcome to API Star, %s!' % name}


routes = [
    Route('/', method='GET', handler=welcome),
]

app = App(routes=routes)


if __name__ == '__main__':
    app.serve('127.0.0.1', 5000, debug=True)
```

### apidoc

* æ¯æ¬¡å¯¼å‡ºæ¥å£æ–‡æ¡£éƒ½å¿…é¡»è¦è®©apidocè¯»å–åˆ°apidoc.jsonæ–‡ä»¶(å¦‚æœæœªæ·»åŠ é…ç½®æ–‡ä»¶ï¼Œå¯¼å‡ºæŠ¥é”™)ï¼Œå¯ä»¥åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹æ·»åŠ apidoc.jsonæ–‡ä»¶
* é¡¹ç›®ä¸­ä½¿ç”¨äº†package.jsonæ–‡ä»¶(ä¾‹å¦‚:node.jså·¥ç¨‹)ï¼Œå¯ä»¥å°†apidoc.jsonæ–‡ä»¶ä¸­çš„æ‰€æœ‰é…ç½®ä¿¡æ¯æ”¾åˆ°package.jsonæ–‡ä»¶ä¸­çš„apidocå‚æ•°ä¸­
* å‚æ•°
    - name
    - version
    - description
    - title
    - url
    - header.title
    - header.filename   é¡µçœ‰æ–‡ä»¶å(markdown)
    - footer.title    é¡µè„šå¯¼èˆªæ ‡é¢˜
    - footer.filename     é¡µè„šæ–‡ä»¶å(markdown)
    - order   æ¥å£åç§°æˆ–æ¥å£ç»„åç§°çš„æ’åºåˆ—è¡¨,å¦‚æœæœªå®šä¹‰ï¼Œé‚£ä¹ˆæ‰€æœ‰åç§°ä¼šè‡ªåŠ¨æ’åº "Error", "Define", "PostTitleAndError", "PostError"

```
# å®‰è£…
npm install apidoc -g
apidoc -i myapp/ -o apidoc/ -t mytemplate/

# æ”¯æŒä¸­æ–‡title

# apidoc.json
{
  "name": "example",
  "version": "0.1.0",
  "description": "apiDoc basic example",
  "title": "Custom apiDoc browser title",
  "url" : "https://api.github.com/v1"
}

# package.json
{
  "name": "example",
  "version": "0.1.0",
  "description": "apiDoc basic example",
  "apidoc": {
    "title": "Custom apiDoc browser title",
    "url" : "https://api.github.com/v1"
  }
}

## è¯­æ³•
# æ³¨é‡Šæ¨¡å—: é€šç”¨å¯å¤ç”¨çš„æ³¨é‡Šæ¨¡å—(ä¾‹å¦‚:æ¥å£é”™è¯¯å“åº”æ¨¡å—),åªéœ€è¦åœ¨æºä»£ç ä¸­å®šä¹‰ä¸€æ¬¡ï¼Œä¾¿å¯ä»¥åœ¨å…¶ä»–æ³¨é‡Šæ¨¡å—ä¸­éšä¾¿å¼•ç”¨ï¼Œæœ€ååœ¨æ–‡æ¡£å¯¼å‡ºæ—¶ä¼šè‡ªåŠ¨æ›¿æ¢æ‰€å¼•ç”¨çš„æ³¨é‡Šæ¨¡å—ï¼Œå®šä¹‰ä¹‹åæ‚¨å¯ä»¥é€šè¿‡@apiUseæ¥å¼•å…¥æ‰€å®šä¹‰çš„æ³¨é‡Šæ¨¡å—
/**
 * @apiDefine name [title]
                     [description]
 */
/**
 * @apiDefine MyError
 * @apiError [(group)] [{type}] field [description]
  * @apiError UserNotFound The <code>id</code> of the User was not found.
 */
/**
 * @apiDefine admin User access only
 * This optional description belong to to the group admin.
 */
/**
 * @apiDefine MySuccess
 * @apiSuccess {string} firstname The users firstname.
 * @apiSuccess {number} age The users age.
 */

# æ ‡æ³¨ä¸€ä¸ªæ¥å£å·²ç»è¢«å¼ƒç”¨
/**
 * @apiDeprecated use now (#Group:Name).
 *
 * Example: to set a link to the GetDetails method of your group User
 * write (#User:GetDetails)
 */

/**
 * @apiIgnore [hint]
 * @apiIgnore Not finished Method

 * @api {method} path [title]
 * @api {get} /user/:id

 * @apiVersion 1.6.2

 * @apiName name
 *
 * @apiDescription This is the Description.
 * It is multiline capable.
 *
 * Last line of Description.

 * @apiGroup User

 * @appUse MyError
 * @apiPermission admin|none
 * @apiUse MySuccess

 * # å®šä¹‰ä¸ºç§æœ‰çš„æ¥å£ï¼Œå¯ä»¥åœ¨ç”Ÿæˆæ¥å£æ–‡æ¡£çš„æ—¶å€™ï¼Œé€šè¿‡åœ¨å‘½ä»¤è¡Œä¸­è®¾ç½®å‚æ•° --private false|trueæ¥å†³å®šå¯¼å‡ºçš„æ–‡æ¡£ä¸­æ˜¯å¦åŒ…å«ç§æœ‰æ¥å£
 * @apiPrivate
 *
 * å¯¼å‡ºçš„htmlæ¥å£æ–‡æ¡£ä¸­ä¼šåŒ…å«æ¨¡æ‹Ÿæ¥å£è¯·æ±‚çš„formè¡¨å•ï¼›å¦‚æœåœ¨é…ç½®æ–‡ä»¶apidoc.jsonä¸­è®¾ç½®äº†å‚æ•°sampleUrl,é‚£ä¹ˆå¯¼å‡ºçš„æ–‡æ¡£ä¸­æ¯ä¸€ä¸ªæ¥å£éƒ½ä¼šåŒ…å«æ¨¡æ‹Ÿæ¥å£è¯·æ±‚çš„formè¡¨å•ï¼Œå¦‚æœæ—¢è®¾ç½®äº†sampleUrlå‚æ•°ï¼ŒåŒæ—¶ä¹Ÿä¸å¸Œæœ›å½“å‰è¿™ä¸ªæ¥å£ä¸åŒ…å«æ¨¡æ‹Ÿæ¥å£è¯·æ±‚çš„formè¡¨å•
 * @apiSampleRequest url
 * @apiSampleRequest off

 * @apiHeader [(group)] [{type}] [field=defaultValue] [description]
 * @apiHeader {String} access-key Users unique access-key.
 * @apiHeaderExample {json} Header-Example:
 *     {
 *       "Accept-Encoding": "Accept-Encoding: gzip, deflate"
 *     }
 *
 * @apiParam [(group)] [{type}] [field=defaultValue] [description]
 * @apiParam {Number} id Users unique ID.
 * @api {post} /user/
 * @apiParam {String} [firstname]  Optional Firstname of the User.
 * @apiParam {String} lastname     Mandatory Lastname.
 * @apiParam {String} country="DE" Mandatory with default value "DE".
 * @apiParam {Number} [age=18]     Optional Age with default 18.
 *
 * @apiParam (Login) {String} pass Only logged in users can post this.
 *                                 In generated documentation a separate
 *                                 "Login" Block will be generated.

 * @apiParamExample [{type}] [title]
                   example
 * @apiParamExample {json} Request-Example:
 *     {
 *       "id": 4711
 *     }
 *
 * @apiError UserNotFound The <code>id</code> of the User was not found.
 * @apiErrorExample [{type}] [title]
 *               example
 * @apiErrorExample {json} Error-Response:
 *     HTTP/1.1 404 Not Found
 *     {
 *       "error": "UserNotFound"
 *     }

 * @apiExample [{type}] title
            example
 * @apiExample {curl} Example usage:
 *     curl -i http://localhost/user/4711
 *
 * @apiSuccess [(group)] [{type}] field [description]
 * @apiSuccess (200) {String} lastname  Lastname of the User.
 * @apiSuccess {Boolean} active        Specify if the account is active.
 * @apiSuccess {Object}  profile       User profile information.
 * @apiSuccess {Number}  profile.age   Users age.
 * @apiSuccess {String}  profile.image Avatar-Image.
 *
 * @apiSuccessExample {json} Success-Response:
 *     HTTP/1.1 200 OK
 *     {
 *       "firstname": "John",
 *       "lastname": "Doe"
 *     }
 */
```

## å‰åç«¯å®è·µ

* é—®é¢˜
    - æ¥å£é¢‘ç¹å˜åŠ¨ï¼šéœ€è¦æé«˜éœ€æ±‚çš„ç†è§£èƒ½åŠ›å’Œæ¥å£è®¾è®¡èƒ½åŠ›
    - æ¥å£æ–‡æ¡£åœ¨å®šæ¥å£æ—¶èµ·åˆ°ä¸€å®šä½œç”¨ï¼Œå†™å®Œæ¥å£å°±æ²¡æœ‰ç”¨äº†
    - æ¥å£æ–‡æ¡£è½åï¼š**æ²¡æœ‰ç»™æˆ‘ä»¬å¸¦æ¥ä»·å€¼**
    - æµ‹è¯•ï¼š â€œææµ‹â€ ä¹‹å‰åªèƒ½å–èŒ¶ï¼Œâ€œææµ‹â€ ä¹‹ååˆå¿™çš„è¦å‘½
* è§£å†³ï¼šè®©æ¥å£æ–‡æ¡£å‘æŒ¥ä»·å€¼ï¼Œæé«˜å˜åŠ¨æ¥å£çš„æˆæœ¬ï¼Œæµ‹è¯•å°½æ—©ä»‹å…¥ã€‚åŠ å¤§å¥‘çº¦ä¿®æ”¹æˆæœ¬
    - æ¥å£æ–‡æ¡£å‘æŒ¥å‡ºä»·å€¼ï¼Œå°±è¦èµ‹äºˆå¥‘çº¦çš„æ„ä¹‰ã€‚
    - å¥‘çº¦åº”è¯¥ç”±å‰ç«¯åŒå­¦æ¥é©±åŠ¨ï¼Œå‰åç«¯å…±åŒåå•†ã€‚ç”±äºå‰ç«¯åŒå­¦ä¸ UX æ¥è§¦æ¯”è¾ƒç´§å¯†ï¼Œæ›´äº†è§£é¡µé¢æ‰€éœ€çš„æ•°æ®ä»¥åŠæ•´ä½“çš„ User Journeyï¼Œå‰ç«¯åŒå­¦é©±åŠ¨ä¼šæ›´åŠ åˆç†ã€‚
    - å¥‘çº¦æ•²å®šä¹‹åï¼Œè¦ç”Ÿæˆ Mock Serverï¼Œå‰åç«¯åŒå­¦å°±è¦ä¾ç…§å¥‘çº¦å„è‡ªå¼€å‘ã€‚Mock Server å¯æš‚æ—¶æ›¿ä»£åå°æœåŠ¡ï¼Œå¸®ç»„å‰ç«¯å¼€å‘ï¼ŒåŒæ—¶ï¼Œæµ‹è¯•åŒå­¦ä¹Ÿå¯ä»¥ä¾ç…§å¥‘çº¦æ–‡æ¡£æ¥ç¼–å†™æµ‹è¯•è„šæœ¬ï¼Œä½¿ç”¨ Mock Server è¿›è¡Œè„šæœ¬éªŒè¯ã€‚
    - åç«¯æ¥å£å‘ç”Ÿå˜åŒ–é™¤äº†å£å¤´é€šçŸ¥ä»¥å¤–å¿…é¡»ä¿®æ”¹å¥‘çº¦ï¼šä¿®æ”¹å¥‘çº¦çš„æˆæœ¬å˜é«˜

## [raml-mocker](https://github.com/xbl/raml-mocker)

åŸºäº Raml ä½¿ç”¨ Nodejs å¼€å‘çš„ Mock Server å·¥å…·ï¼Œä½¿ç”¨ Raml æè¿°æ¥å£ä¸­è®¾ç½® response çš„ example æŒ‡ä»¤å³å¯ï¼Œraml-mocker ä¼šè§£æ Raml æ–‡ä»¶ï¼Œå¹¶å¯åŠ¨ä¸€ä¸ª Mock Serverï¼Œå°†  example çš„å†…å®¹è¿”å›ç»™æµè§ˆå™¨ã€‚

* é…ç½® `.raml-config.json`
    - controller: controller ç›®å½•è·¯å¾„
    - raml: raml æ–‡ä»¶ç›®å½•
    - main: raml ç›®å½•ä¸‹çš„å…¥å£æ–‡ä»¶
    - port:  mock server æœåŠ¡ç«¯å£å·
    - plugins: æ’ä»¶

```sh
git clone https://github.com/xbl/raml-mocker-starter.git raml-api
cd raml-api
git remote rm origin
yarn install
yarn|npm start

curl -i http://localhost:3000/api/v1/users/1/books/
# or
curl -i http://localhost:3000/api/v1/users/1/books/1

# ç”Ÿæˆ API å¯è§†åŒ–æ–‡æ¡£
yarn|npm run build

yarn test
```

## æ¶æ„è°ƒç”¨

## åŠ å¯†

* https:é¢å¯¹charlesç­‰æŠ“åŒ…å·¥å…·æ—¶ï¼Œå…¶å®å¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨ï¼Œåªè¦é…ç½®ä¸€ä¸‹æ ¹è¯ä¹¦ç¬é—´å¯ä»¥çœ‹åˆ°ä¸€åˆ‡æ˜æ–‡

```
// åŠ å¯†å¯†ç 
password = '123456'
// éœ€è¦åŠ å¯†çš„å†…å®¹
message = 'Hello World!'
// åˆ©ç”¨åŠ å¯†å¯†ç å¯¹å†…å®¹è¿›è¡ŒåŠ å¯†
enc_message = encrypt( password, message )
// è§£å¯†
dec_message = decrypt ( password, enc_message )
print dec_message   // Hello World!
```

## æ¥å£

* [public-apis/public-apis](https://github.com/public-apis/public-apis):A collective list of free APIs for use in software and web development. https://ultimatecourses.com
* [é›…è™å¤©æ°”](https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20weather.forecast%20where%20woeid%20%3D%202151330&format=json)
* [ä»·æ ¼](http://api.money.126.net/data/feed/0000001,1399001?callback=refreshPrice)
* [Vespa314/bilibili-api](https://github.com/Vespa314/bilibili-api):Bç«™APIæ”¶é›†æ•´ç†åŠå¼€å‘
* [jokermonn/-Api](https://github.com/jokermonn/-Api):ğŸ“–ã€Œä¸€ä¸ªã€ã€ã€ŒTime æ—¶å…‰ã€ã€ã€Œå¼€çœ¼ã€ã€ã€Œä¸€å¸­ã€ã€ã€Œæ¢¨è§†é¢‘ã€ã€ã€Œå¾®è½¯å¿…åº”è¯å…¸ã€ã€ã€Œé‡‘å±±è¯å…¸ã€ã€ã€Œè±†ç“£ç”µå½±ã€ã€ã€Œä¸­å¤®å¤©æ°”ã€ã€ã€Œé­…æ—å¤©æ°”ã€ã€ã€Œæ¯æ—¥ä¸€æ–‡ã€ã€ã€Œ12306ã€ã€ã€Œé€”ç‰›ã€ã€ã€Œå¿«é€’100ã€ã€ã€Œå¿«é€’ã€åº”ç”¨ Api
* [toddmotto/public-apis](https://github.com/toddmotto/public-apis):A collective list of public JSON APIs for use in web development. https://toddmotto.com
* [pwxcoo/chinese-xinhua](https://github.com/pwxcoo/chinese-xinhua):ğŸ“™ ä¸­åæ–°åå­—å…¸æ•°æ®åº“ã€‚åŒ…æ‹¬æ­‡åè¯­ï¼Œæˆè¯­ï¼Œè¯è¯­ï¼Œæ±‰å­—ã€‚æä¾›æ–°åå­—å…¸APIã€‚
* [Binaryify/NeteaseCloudMusicApi](https://github.com/Binaryify/NeteaseCloudMusicApi):ç½‘æ˜“äº‘éŸ³ä¹ Node.js API service https://binaryify.github.io/NeteaseCloudMusicApi/#/
* è±†ç“£
    - [douban](https://developers.douban.com/wiki/?title=guide)
    - [è·å–æ­£åœ¨çƒ­æ˜ çš„ç”µå½±](https://api.douban.com/v2/movie/in_theaters?city=å¹¿å·&start=0&count=10)
    - [è·å–ç”µå½±Top250](https://api.douban.com/v2/movie/top250?start=0&count=10)
    - [ç”µå½±æœç´¢](https://api.douban.com/v2/movie/search?q=ç¥ç§˜å·¨æ˜Ÿ&start=0&count=10)
    - [ç”µå½±è¯¦æƒ…](https://api.douban.com/v2/movie/subject/26942674)

## å·¥å…·

* [Branca](https://branca.io/):Authenticated and encrypted API tokens using modern crypto.
* [restify](link)
  - validator  joi
  - swagger
  - waterline
  - log:bunyan
  - ava / rewire / supertest / nyc
* Gateway
    - [TykTechnologies/tyk](https://github.com/TykTechnologies/tyk)ï¼šTyk Open Source API Gateway written in Go
* [GoogleChrome/puppeteer](https://github.com/GoogleChrome/puppeteer):Headless Chrome Node API https://try-puppeteer.appspot.com/
* [thx/RAP](https://github.com/thx/RAP):Webæ¥å£ç®¡ç†å·¥å…·ï¼Œå¼€æºå…è´¹ï¼Œæ¥å£è‡ªåŠ¨åŒ–ï¼ŒMOCKæ•°æ®è‡ªåŠ¨ç”Ÿæˆï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œä¼ä¸šçº§ç®¡ç†ã€‚é˜¿é‡Œå¦ˆå¦ˆMUXå›¢é˜Ÿå‡ºå“ï¼é˜¿é‡Œå·´å·´éƒ½åœ¨ç”¨ï¼1000+å…¬å¸çš„é€‰æ‹©ï¼RAP2å·²å‘å¸ƒè¯·ç§»æ­¥è‡³https://github.com/thx/rap2-delos http://rapapi.org
* [thx/rap2-delos](https://github.com/thx/rap2-delos):é˜¿é‡Œå¦ˆå¦ˆå‰ç«¯å›¢é˜Ÿå‡ºå“çš„å¼€æºæ¥å£ç®¡ç†å·¥å…·RAPç¬¬äºŒä»£ http://rap2.taobao.org
* [encode/apistar](https://github.com/encode/apistar):A smart Web API framework, for Python 3. ğŸŒŸ https://docs.apistar.com
* [ruby-grape/grape](https://github.com/ruby-grape/grape):An opinionated framework for creating REST-like APIs in Ruby. http://www.ruby-grape.org
* [encode/django-rest-framework](https://github.com/encode/django-rest-framework):Web APIs for Django. âš¡ï¸ https://www.django-rest-framework.org
* [paularmstrong/normalizr](https://github.com/paularmstrong/normalizr):Normalizes nested JSON according to a schema
* [dingo/api](https://github.com/dingo/api):A RESTful API package for the Laravel and Lumen frameworks.
* [parse-community/parse-server](https://github.com/parse-community/parse-server):Parse-compatible API server module for Node/Express http://parseplatform.org
* [interagent/http-api-design](https://github.com/interagent/http-api-design):HTTP API design guide extracted from work on the Heroku Platform API https://www.gitbook.com/read/book/geeâ€¦
* [typicode/json-server](https://github.com/typicode/json-server):Get a full fake REST API with zero coding in less than 30 seconds (seriously)
* [tobscure/json-api](https://github.com/tobscure/json-api):JSON-API (http://jsonapi.org) responses in PHP.
* [hashicorp/vault](https://github.com/hashicorp/vault)ï¼šA tool for secrets management, encryption as a service, and privileged access management https://www.vaultproject.io/
* [nsf/termbox-go](https://github.com/nsf/termbox-go):Pure Go termbox implementation http://code.google.com/p/termbox
* [apiaryio/dredd](https://github.com/apiaryio/dredd):Language-agnostic HTTP API Testing Tool https://dredd.rtfd.io
* [hellofresh/janus](https://github.com/hellofresh/janus):An API Gateway written in Go https://hellofresh.gitbooks.io/janus
* [SocketLog](https://github.com/luofei614/SocketLog)
* åŠ å¯†
    - [google/tink](https://github.com/google/tink):Tink is a multi-language, cross-platform library that provides cryptographic APIs that are secure, easy to use correctly, and hard(er) to misuse.
    - [JSEncrypt](https://github.com/travist/jsencrypt):ç”¨äºæ‰§è¡ŒOpenSSL RSAåŠ å¯†ã€è§£å¯†å’Œå¯†é’¥ç”Ÿæˆçš„Javascriptåº“ã€‚WEB çš„ç™»å½•åŠŸèƒ½æ—¶ä¸€èˆ¬æ˜¯é€šè¿‡ Form æäº¤æˆ– Ajax æ–¹å¼æäº¤åˆ°æœåŠ¡å™¨è¿›è¡ŒéªŒè¯çš„ã€‚ä¸ºäº†é˜²æ­¢æŠ“åŒ…ï¼Œç™»å½•å¯†ç è‚¯å®šè¦å…ˆè¿›è¡Œä¸€æ¬¡åŠ å¯†ï¼ˆRSAï¼‰ï¼Œå†æäº¤åˆ°æœåŠ¡å™¨è¿›è¡ŒéªŒè¯
* æµ‹è¯•
  - Poster ç«ç‹æµè§ˆå™¨çš„ä¸€ä¸ªæ’ä»¶
    - postman
    - [liyasthomas/postwoman](https://github.com/liyasthomas/postwoman):https://github.com/liyasthomas/postwoman
    - [apiaryio/dredd](https://github.com/apiaryio/dredd):Language-agnostic HTTP API Testing Tool https://dredd.org
    - [airbnb/hypernova](https://github.com/airbnb/hypernova):A service for server-side rendering your JavaScript views
    - RESTClientæ˜¯ç”¨java Swingç¼–å†™çš„åŸºäºhttpåè®®çš„æ¥å£æµ‹è¯•å·¥å…·
    - Fiddleræ˜¯ä¸€ä¸ªhttpåè®®è°ƒè¯•ä»£ç†å·¥å…·ï¼Œå®ƒèƒ½å¤Ÿè®°å½•å¹¶æ£€æŸ¥æ‰€æœ‰ä½ çš„ç”µè„‘å’Œäº’è”ç½‘ä¹‹é—´çš„httpé€šè®¯ï¼Œè®¾ç½®æ–­ç‚¹ï¼ŒæŸ¥çœ‹æ‰€æœ‰çš„â€œè¿›å‡ºâ€Fiddlerçš„æ•°æ®ï¼ˆæŒ‡cookie,html,js,cssç­‰æ–‡ä»¶ï¼Œè¿™äº›éƒ½å¯ä»¥èƒ¡ä¹±ä¿®æ”¹çš„æ„æ€ï¼‰,æµ‹è¯•çš„æ•°æ®éƒ½å¯ä»¥ä¿å­˜,ä½†æµ‹è¯•è®°å½•ä¸æ–¹ä¾¿æŸ¥è¯¢
    - SoapUIæ˜¯ä¸€ä¸ªå…è´¹ã€å¼€æºã€è·¨å¹³å°çš„åŠŸèƒ½æµ‹è¯•è§£å†³æ–¹æ¡ˆã€‚ä¸€ä¸ªæ˜“äºä½¿ç”¨çš„å›¾å½¢ç•Œé¢ï¼Œå’Œä¼ä¸šçº§åŠŸèƒ½ï¼Œè®©ä½ è½»æ¾å’ŒsoapUIè¿…é€Ÿåˆ›å»ºå’Œæ‰§è¡Œè‡ªåŠ¨åŒ–çš„åŠŸèƒ½ï¼Œå›å½’æµ‹è¯•å’Œè´Ÿè½½æµ‹è¯•
    - Apache JMeteræ˜¯Apacheç»„ç»‡å¼€å‘çš„åŸºäºJavaçš„å¼€æºçš„æµ‹è¯•å·¥å…·ï¼Œ JMeter å¯ä»¥ç”¨äºå¯¹æœåŠ¡å™¨ã€ç½‘ç»œæˆ–å¯¹è±¡æ¨¡æ‹Ÿå·¨å¤§çš„è´Ÿè½½ï¼Œæ¥è‡ªä¸åŒå‹åŠ›ç±»åˆ«ä¸‹æµ‹è¯•å®ƒä»¬çš„å¼ºåº¦å’Œåˆ†ææ•´ä½“æ€§èƒ½,å¯¹åº”ç”¨ç¨‹åºåšåŠŸèƒ½/å›å½’æµ‹è¯•/æ¥å£æµ‹è¯•ï¼ŒåŒæ—¶Jmeter+Ant+Jenkinsä¹Ÿå¯ä»¥æ­å»ºæ¥å£å’Œæ€§èƒ½çš„æŒç»­é›†æˆæµ‹è¯•å¹³å°
    - WireMockæ˜¯ä¸€ä¸ªéå¸¸è½»é‡çº§çš„æ”¯æŒHTTP mockçš„æœåŠ¡,å¯ä»¥ç”¨äºå•å…ƒæµ‹è¯•æˆ–æ¨¡æ‹Ÿæµ‹è¯•ç¯å¢ƒæœåŠ¡ç«¯ï¼Œå®ƒæ”¯æŒHTTPå“åº”å¤´ï¼Œè¯·æ±‚éªŒè¯ï¼Œä»£ç†/æ‹¦æˆªï¼Œè®°å½•/å›æ”¾å­˜æ ¹å’Œæ•…éšœæ³¨å…¥
    - å†’çƒŸæµ‹è¯•ç”¨posterï¼Œé›†æˆæµ‹è¯•ç”¨Jmeter
* æ–‡æ¡£
    - [swagger-api/swagger-ui](https://github.com/swagger-api/swagger-ui):Swagger UI is a collection of HTML, Javascript, and CSS assets that dynamically generate beautiful documentation from a Swagger-compliant API. http://swagger.io
    - [YMFE/yapi](https://github.com/YMFE/yapi):YApi æ˜¯ä¸€ä¸ªå¯æœ¬åœ°éƒ¨ç½²çš„ã€æ‰“é€šå‰åç«¯åŠQAçš„ã€å¯è§†åŒ–çš„æ¥å£ç®¡ç†å¹³å° http://yapi.demo.qunar.com/
    * [gongwalker/ApiManager](https://github.com/gongwalker/ApiManager):æ¥å£æ–‡æ¡£ç®¡ç†å·¥å…·
    - [jsdoc3/jsdoc](https://github.com/jsdoc3/jsdoc):An API documentation generator for JavaScript. http://usejsdoc.org
    - [swagger](https://app.swaggerhub.com/home)Swagger UI is a collection of HTML, Javascript, and CSS assets that dynamically generate beautiful documentation from a Swagger-compliant API. http://swagger.io
    - [freeCodeCamp/devdocs](https://github.com/freeCodeCamp/devdocs):API Documentation Browser https://devdocs.io
    - [lord/slate](https://github.com/lord/slate):Beautiful static documentation for your API https://spectrum.chat/slate
    - YUI doc
    - eolinker
    - Apizza
    - Yapi
    - [RAP2](http://rap2.taobao.org)
    - DOClever
    - [insomnia](https://insomnia.rest/):Design and debug APIs like a human, not a robot.
    - [star7th / showdoc](https://github.com/star7th/showdoc):ShowDoc is a tool greatly applicable for an IT team to share documents onlineä¸€ä¸ªéå¸¸é€‚åˆITå›¢é˜Ÿçš„åœ¨çº¿APIæ–‡æ¡£ã€æŠ€æœ¯æ–‡æ¡£å·¥å…· https://www.showdoc.cc
* æŠ“åŒ…
    - Charles
    - fiddler
    - [Wireshark](https://www.wireshark.org)
    - [avwo/whistle](https://github.com/avwo/whistle):HTTP, HTTP2, HTTPS, Websocket debugging proxy https://wproxy.org/
* API æ–‡æ¡£/å¥‘çº¦ç”Ÿæˆå·¥å…·
    - apidoc
    - swagger
    - blue sprint
    - RAML
* mock
    - wiremock
    - json-server
    - node-mock-server
    - node-mocks-http
    - [nuysoft/Mock](https://github.com/nuysoft/Mock):A simulation data generator http://mockjs.com
* HTTP è¯·æ±‚æ‹¦æˆªå™¨
    - axios-mock-adapter
    - jquery-mockjax
* å¥‘çº¦/API æµ‹è¯•å·¥å…·
    - Spring Cloud Contract
    - Pact
    - Rest-Assured
* HoServer
* [APIJSON / APIJSON](https://github.com/APIJSON/APIJSON):ğŸ†ç äº‘æœ€æœ‰ä»·å€¼å¼€æºé¡¹ç›® ğŸš€åç«¯æ¥å£å’Œæ–‡æ¡£è‡ªåŠ¨åŒ–ï¼Œå‰ç«¯(å®¢æˆ·ç«¯) å®šåˆ¶è¿”å› JSON çš„æ•°æ®å’Œç»“æ„ï¼ğŸ†Gitee Most Valuable Project ğŸš€A JSON Transmission Protocol and an ORM Library for automatically providing APIs and Docs. http://apijson.org

## å‚è€ƒ

* [OAI/OpenAPI-Specification](https://github.com/OAI/OpenAPI-Specification):The OpenAPI Specification Repository https://openapis.org
* [jsonapi](https://jsonapi.org/format/)
* [shieldfy/API-Security-Checklist](https://github.com/shieldfy/API-Security-Checklist):Checklist of the most important security countermeasures when designing, testing, and releasing your API
* [microsoft/api-guidelines](https://github.com/microsoft/api-guidelines):Microsoft REST API Guidelines
* [Best Practices for Designing a Pragmatic RESTful API](https://www.vinaysahni.com/best-practices-for-a-pragmatic-restful-api)
